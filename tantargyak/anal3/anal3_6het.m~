%% 
%  
%  file:   anal3_6het.m
%  author: Polcz PÃ©ter <ppolcz@gmail.com> 
%  
%  Created on 2016.09.30. Friday, 12:57:45
%

%%

mlt = 5;
Nw = 31;
w = hamming(Nw);
w = w / sum(w);

N = 1000;
s = conv(rand(1,N)*100,w,'same').^2;
for i=1:mlt; s = conv(s,w,'same'); end

s = s(Nw*mlt:end-Nw*mlt).^2;
s = s - min(s);
s = s / max(s) + 0.1;

a = s(1);
b = s(2);

t = (0:numel(s)-1)/(numel(s)-1);
r = s + t*(-s(end)+s(1))+2;
theta = t*2*pi;

x = r.*cos(theta);
y = r.*sin(theta);

% plot(t,r,t,theta)
plot(x,y)

%%

figure, hold on, grid on

i = round(numel(x) * 0.15);

plot(x,y)
plot([0,x(i)], [0,y(i)])

l = 5;
quiver(0,0,l,0,'k')
quiver(0,0)

%%

