function Downed=DownsampleMatrix(InputMat)%18.086 Final Project%By Joseph Kovac%Revised and submitted for OCW 9/12/05global DebugRes%InputMat includes exterior points%Output is residual matrix zero padded%Get the interior part of the gridInteriorEdge=sqrt(prod(size(InputMat)))-2;G=RemoveBoundaries(InputMat);%Create the Coarsening matrixDowner=CreateCoarsener(InteriorEdge,InteriorEdge);%Downsample the interior gridrnew=Downer*G';DebugRes=rnew;%Pad the resuling residual matrix with zeros on the edgesDowned=AddResidualZeros(WrapVector(rnew));