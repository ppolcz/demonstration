(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    199242,       6979]
NotebookOptionsPosition[    187434,       6575]
NotebookOutlinePosition[    188230,       6601]
CellTagsIndexPosition[    188187,       6598]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Initialization", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "NC`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "NCAlgebra`"}]}], "Input",
 CellChangeTimes->{{3.668084359247946*^9, 3.668084363582427*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{
  3.66808436581479*^9, {3.668084398970811*^9, 3.6680844161482677`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/mauricio/NC\"\>"}],
  SequenceForm["  ", "/Users/mauricio/NC"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66808436581479*^9, {3.668084398970811*^9, 3.668084416151754*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"You can now use \\\"<< NCAlgebra`\\\" to load NCAlgebra or \
\"\>", "\[InvisibleSpace]", "\<\"\\\"<< NCGB`\\\" to load NCGB.\"\>"}],
  SequenceForm[
  "You can now use \"<< NCAlgebra`\" to load NCAlgebra or ", 
   "\"<< NCGB`\" to load NCGB."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.66808436581479*^9, {3.668084398970811*^9, 3.668084416155753*^9}}]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"NCSetOutput", "[", 
  RowBox[{"All", "\[Rule]", "True"}], "]"}]], "Input",
 CellChangeTimes->{{3.6680843809796963`*^9, 3.668084393816415*^9}, {
  3.668084442654065*^9, 3.668084443149218*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plant and controller equations", "Subsection"],

Cell["Plant matrix:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{
  "Ap", ",", "Bw", ",", "Bu", ",", "Ca", ",", "Dzw", ",", "Dzu", ",", "Cy", 
   ",", "Dyw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plant", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ap", ",", "Bw", ",", "Bu"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Cz", ",", "Dzw", ",", "Dzu"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Cy", ",", "Dyw", ",", "0"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.668084431156118*^9, 3.66808443322007*^9}, {
  3.668084979505631*^9, 3.668084997698555*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"Ap", "Bw", "Bu"},
     {"Cz", "Dzw", "Dzu"},
     {"Cy", "Dyw", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.66808443660458*^9, 3.66808444517171*^9}, 
   3.6680849993628197`*^9, 3.6680850940998774`*^9}]
}, Open  ]],

Cell["Plant signals:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"z", ",", "y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"xdotzy", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "'"}], ",", "z", ",", "y"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.668084451718012*^9, 3.668084452662237*^9}, {
  3.6680847228679543`*^9, 3.668084726476091*^9}, {3.668085003010317*^9, 
  3.668085010808704*^9}, {3.668085068448846*^9, 3.66808509136624*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["x", "\[Prime]",
    MultilineFunction->None], ",", "z", ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{
  3.668084453110209*^9, 3.6680847268878517`*^9, 3.668085011261368*^9, {
   3.6680850713596888`*^9, 3.66808509513523*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"x", ",", "w", ",", "u"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"xwu", "=", 
  RowBox[{"{", 
   RowBox[{"x", ",", "w", ",", "u"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.668084456866953*^9, 3.66808445785925*^9}, {
  3.668084728659939*^9, 3.668084731635749*^9}, {3.66808501447402*^9, 
  3.668085018989087*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x", ",", "w", ",", "u"}], "}"}]], "Output",
 CellChangeTimes->{3.668084458256277*^9, 3.6680847320863447`*^9, 
  3.6680850195323887`*^9, 3.668085097566023*^9}]
}, Open  ]],

Cell["Controller matrix", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"Ac", ",", "Bc", ",", "Cc", ",", "Dc"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Controller", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ac", ",", "Bc"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Cc", ",", "Dc"}], "}"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.668084463690892*^9, 3.668084464595066*^9}, {
  3.668085024030871*^9, 3.668085030589315*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"Ac", "Bc"},
     {"Cc", "Dc"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.668084464979391*^9, 3.668084734399703*^9, 
  3.668085031925454*^9, 3.668085099454417*^9}]
}, Open  ]],

Cell["Controller signals", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"xc", ",", "w", ",", "u"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"xcdotu", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"xc", "'"}], ",", "u"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.6680844720960913`*^9, 3.668084473143839*^9}, {
  3.668084737201626*^9, 3.668084740640973*^9}, {3.668085058213257*^9, 
  3.668085062099777*^9}, {3.66808510438629*^9, 3.668085107991569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SuperscriptBox["xc", "\[Prime]",
    MultilineFunction->None], ",", "u"}], "}"}]], "Output",
 CellChangeTimes->{3.668084473868986*^9, 3.668084741264215*^9, 
  3.668085109121336*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xcy", "=", 
  RowBox[{"{", 
   RowBox[{"xc", ",", "y"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6680844788852673`*^9, 3.668084479772581*^9}, {
  3.668084743441391*^9, 3.668084745545122*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"xc", ",", "y"}], "}"}]], "Output",
 CellChangeTimes->{3.668084480069628*^9, 3.668084746099518*^9, 
  3.668085111138899*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the closed loop matrices with NCGB", "Subsection"],

Cell["Set plant and controller as equations:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq1", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"xdotzy", "\[Equal]", 
     RowBox[{"Plant", "**", "xwu"}]}], "//", "NCMatrixExpand"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.668084641101572*^9, 3.668084715417089*^9}, {
  3.66808475087801*^9, 3.6680847599148903`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Ap", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bu", ".", "u"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bw", ".", "w"}],
      HoldForm]}]}], ",", 
   RowBox[{"z", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cz", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dzu", ".", "u"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dzw", ".", "w"}],
      HoldForm]}]}], ",", 
   RowBox[{"y", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cy", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dyw", ".", "w"}],
      HoldForm]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.668084655065455*^9, 3.6680847081124477`*^9}, {
   3.668084752501391*^9, 3.668084760210307*^9}, 3.668085116825328*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eq2", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"xcdotu", "\[Equal]", 
     RowBox[{"Controller", "**", "xcy"}]}], "//", "NCMatrixExpand"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.668084767529929*^9, 3.66808478977614*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["xc", "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Ac", ".", "xc"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bc", ".", "y"}],
      HoldForm]}]}], ",", 
   RowBox[{"u", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cc", ".", "xc"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dc", ".", "y"}],
      HoldForm]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.668084791934875*^9, 3.668085118576748*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqns", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"eq1", ",", "eq2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6680845147265663`*^9, 3.668084584323208*^9}, {
  3.668084780544112*^9, 3.668084801362177*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Ap", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bu", ".", "u"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bw", ".", "w"}],
      HoldForm]}]}], ",", 
   RowBox[{"z", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cz", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dzu", ".", "u"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dzw", ".", "w"}],
      HoldForm]}]}], ",", 
   RowBox[{"y", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cy", ".", "x"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dyw", ".", "w"}],
      HoldForm]}]}], ",", 
   RowBox[{
    SuperscriptBox["xc", "\[Prime]",
     MultilineFunction->None], "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Ac", ".", "xc"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Bc", ".", "y"}],
      HoldForm]}]}], ",", 
   RowBox[{"u", "\[Equal]", 
    RowBox[{
     TagBox[
      RowBox[{"Cc", ".", "xc"}],
      HoldForm], "+", 
     TagBox[
      RowBox[{"Dc", ".", "y"}],
      HoldForm]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.668084521414665*^9, 3.668084586257474*^9}, {
   3.668084618287736*^9, 3.668084629034871*^9}, 3.6680848017791758`*^9, 
   3.668085120172105*^9}]
}, Open  ]],

Cell["Define the unknwons", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"SetNonCommutative", "[", 
  RowBox[{"xDot", ",", "xcDot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"rule", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x", "'"}], "\[Rule]", "xDot"}], ",", 
    RowBox[{
     RowBox[{"xc", "'"}], "\[Rule]", "xcDot"}]}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    SuperscriptBox["x", "\[Prime]",
     MultilineFunction->None], "\[Rule]", "xDot"}], ",", 
   RowBox[{
    SuperscriptBox["xc", "\[Prime]",
     MultilineFunction->None], "\[Rule]", "xcDot"}]}], "}"}]], "Output",
 CellChangeTimes->{3.668085693289361*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"poly", "=", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"{", "eqns", "}"}], "/.", 
     RowBox[{"Equal", "\[Rule]", "Subtract"}]}], "]"}], "/.", 
   "rule"}]}]], "Input",
 CellChangeTimes->{{3.668085509462358*^9, 3.668085601728477*^9}, {
  3.66808569498418*^9, 3.668085698325718*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"xDot", "-", 
       TagBox[
        RowBox[{"Ap", ".", "x"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Bu", ".", "u"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Bw", ".", "w"}],
        HoldForm]}]},
     {
      RowBox[{"z", "-", 
       TagBox[
        RowBox[{"Cz", ".", "x"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Dzu", ".", "u"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Dzw", ".", "w"}],
        HoldForm]}]},
     {
      RowBox[{"y", "-", 
       TagBox[
        RowBox[{"Cy", ".", "x"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Dyw", ".", "w"}],
        HoldForm]}]},
     {
      RowBox[{"xcDot", "-", 
       TagBox[
        RowBox[{"Ac", ".", "xc"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Bc", ".", "y"}],
        HoldForm]}]},
     {
      RowBox[{"u", "-", 
       TagBox[
        RowBox[{"Cc", ".", "xc"}],
        HoldForm], "-", 
       TagBox[
        RowBox[{"Dc", ".", "y"}],
        HoldForm]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6680855313911123`*^9, 3.668085546119677*^9}, {
   3.668085578275874*^9, 3.668085602144903*^9}, 3.668085698763962*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "'"}], ",", 
     RowBox[{"xc", "'"}], ",", "z", ",", "u", ",", "y"}], "}"}], "/.", 
   "rule"}]}]], "Input",
 CellChangeTimes->{{3.668084812623663*^9, 3.668084820147882*^9}, {
  3.6680851273550262`*^9, 3.66808513001755*^9}, {3.668085709699868*^9, 
  3.6680857108746023`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"xDot", ",", "xcDot", ",", "z", ",", "u", ",", "y"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.668084820786841*^9, 3.668085130480927*^9, 
  3.6680857112938347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCToNCPolynomial", "[", 
  RowBox[{"poly", ",", "unknowns"}], "]"}]], "Input",
 CellChangeTimes->{{3.6680856057170773`*^9, 3.668085621242453*^9}}],

Cell[BoxData[
 RowBox[{"NCPolynomial", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        TagBox[
         RowBox[{"Ap", ".", "x"}],
         HoldForm]}], "-", 
       TagBox[
        RowBox[{"Bw", ".", "w"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        TagBox[
         RowBox[{"Cz", ".", "x"}],
         HoldForm]}], "-", 
       TagBox[
        RowBox[{"Dzw", ".", "w"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        TagBox[
         RowBox[{"Cy", ".", "x"}],
         HoldForm]}], "-", 
       TagBox[
        RowBox[{"Dyw", ".", "w"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", 
       TagBox[
        RowBox[{"Ac", ".", "xc"}],
        HoldForm]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"-", 
       TagBox[
        RowBox[{"Cc", ".", "xc"}],
        HoldForm]}], "}"}]}], "}"}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "xDot", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}]}], "}"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", "u", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "Bu", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "Dzu", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "1", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", "z", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}]}], "}"}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", "y", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "Bc", "}"}], ",", 
            RowBox[{"{", "0", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "Dc", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", "xcDot", "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "0", "}"}], ",", 
           RowBox[{"{", "1", "}"}], ",", 
           RowBox[{"{", "0", "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}]}], "}"}], "}"}]}]}], 
    "\[RightAssociation]"}], ",", 
   RowBox[{"{", 
    RowBox[{"xDot", ",", "xcDot", ",", "z", ",", "u", ",", "y"}], "}"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.668085624665007*^9, 3.668085712923634*^9}]
}, Open  ]],

Cell["Call NCEliminate to solve the equations:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"MatrixToList", "[", "eqns", "]"}], ",", "unknowns", ",", "10"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      StyleBox["y",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}]}]}]},
    {
     RowBox[{
      StyleBox["xcdot",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["xc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}]}]}]},
    {
     RowBox[{
      StyleBox["u",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["xc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}]}]}]},
    {
     RowBox[{
      StyleBox["xdot",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{
        StyleBox["Ap",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["xc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}]}]}]},
    {
     RowBox[{
      StyleBox["z",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["xc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["x",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["w",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 0, 1]]}]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
   y -> NonCommutativeMultiply[Cy, x] + NonCommutativeMultiply[Dyw, w], xcdot -> 
    NonCommutativeMultiply[Ac, xc] + NonCommutativeMultiply[Bc, Cy, x] + 
     NonCommutativeMultiply[Bc, Dyw, w], u -> 
    NonCommutativeMultiply[Cc, xc] + NonCommutativeMultiply[Dc, Cy, x] + 
     NonCommutativeMultiply[Dc, Dyw, w], xdot -> 
    NonCommutativeMultiply[Ap, x] + NonCommutativeMultiply[Bw, w] + 
     NonCommutativeMultiply[Bu, Cc, xc] + 
     NonCommutativeMultiply[Bu, Dc, Cy, x] + 
     NonCommutativeMultiply[Bu, Dc, Dyw, w], z -> 
    NonCommutativeMultiply[Cz, x] + NonCommutativeMultiply[Dzw, w] + 
     NonCommutativeMultiply[Dzu, Cc, xc] + 
     NonCommutativeMultiply[Dzu, Dc, Cy, x] + 
     NonCommutativeMultiply[Dzu, Dc, Dyw, w]}],
  Editable->False]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extracting the closed loop matrices", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ClosedLoopRhs", "=", 
  RowBox[{"MatrixAffineFactor", "[", 
   RowBox[{
    RowBox[{"ReplaceAll", "[", 
     RowBox[{
      RowBox[{"Matrix", "[", 
       RowBox[{
        RowBox[{"{", "xdot", "}"}], ",", 
        RowBox[{"{", "xcdot", "}"}], ",", 
        RowBox[{"{", "z", "}"}]}], "]"}], ",", "solution"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "xc", ",", "w"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "+", 
        RowBox[{
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "**", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}], 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], 
       RowBox[{
        StyleBox["Ap",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "+", 
        RowBox[{
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "**", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}]},
      {
       RowBox[{
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], 
       StyleBox["Ac",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]], 
       RowBox[{
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]},
      {
       RowBox[{
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "+", 
        RowBox[{
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "**", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}], 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], 
       RowBox[{
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "+", 
        RowBox[{
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "**", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}]}
     }], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "**", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       StyleBox["w",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]]},
      {
       StyleBox["xc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]]},
      {
       StyleBox["x",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]]}
     }], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClosedLoop", "=", 
   RowBox[{"ReplaceAll", "[", 
    RowBox[{"ClosedLoopRhs", ",", 
     RowBox[{
      RowBox[{"a_", "**", "b_"}], "\[Rule]", "a"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ClosedLoop", "=", 
  RowBox[{"ClosedLoop", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "2", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       StyleBox["Ap",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["Cc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]]}], 
      RowBox[{
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       StyleBox["Bc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]], "**", 
       StyleBox["Cy",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], 
      StyleBox["Ac",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], 
      RowBox[{
       StyleBox["Bc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]], "**", 
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["Cc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]]}], 
      RowBox[{
       StyleBox["Dzw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Acl", "=", 
   RowBox[{"ClosedLoop", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bcl", "=", 
   RowBox[{"ClosedLoop", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ccl", "=", 
   RowBox[{"ClosedLoop", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Dcl", "=", 
   RowBox[{"ClosedLoop", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{"{", "3", "}"}]}], "]"}], "]"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["The Bounded Real Lemma", "Section"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetCommutative", "[", "mu", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BRLol", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"tp", "[", "Aol", "]"}], "**", "Pol"}], "+", 
       RowBox[{"Pol", "**", "Aol"}]}], ",", 
      RowBox[{"tp", "[", "Col", "]"}], ",", 
      RowBox[{"Pol", "**", "Bol"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Col", ",", 
      RowBox[{"-", "mu"}], ",", "Dol"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", "Bol", "]"}], "**", "Pol"}], ",", 
      RowBox[{"tp", "[", "Dol", "]"}], ",", 
      RowBox[{"-", "mu"}]}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["Pol",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Aol",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Aol",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Pol",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{"tp", "[", 
       StyleBox["Col",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "]"}], 
      RowBox[{
       StyleBox["Pol",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bol",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {
      StyleBox["Col",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      StyleBox["Dol",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]]},
     {
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Bol",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Pol",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{"tp", "[", 
       StyleBox["Dol",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "]"}], 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Pcl", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"X", ",", "Y"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Y", ",", "Y"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], 
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]},
     {
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], 
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BRLcl", "=", 
  RowBox[{"MatrixFlatten", "[", 
   RowBox[{"NCExpand", "[", 
    RowBox[{"BRLol", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Pol", "\[Rule]", "Pcl"}], ",", 
       RowBox[{"Aol", "\[Rule]", "Acl"}], ",", 
       RowBox[{"Bol", "\[Rule]", "Bcl"}], ",", 
       RowBox[{"Col", "\[Rule]", "Ccl"}], ",", 
       RowBox[{"Dol", "\[Rule]", "Dcl"}]}], "}"}]}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], 
      RowBox[{
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Ac",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Ac",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], 
      RowBox[{
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["Cc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]]}], 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       StyleBox["Dzw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elimination", "Section"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BRLe", "=", 
  RowBox[{"MatrixAffineFactor", "[", 
   RowBox[{"BRLcl", ",", 
    RowBox[{"{", 
     RowBox[{"Ac", ",", "Bc", ",", "Cc", ",", "Dc"}], "}"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       RowBox[{
        RowBox[{
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}], "+", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["A",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}]}], 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], 
       RowBox[{"tp", "[", 
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]},
      {
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "0", "0", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]},
      {
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "0", 
       RowBox[{"-", 
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], 
       StyleBox["Dzw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]},
      {
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], 
       RowBox[{"tp", "[", 
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], 
       RowBox[{"-", 
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}
     }], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "+", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", 
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]},
       {"1", "0"},
       {"0", "0"},
       {"0", 
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "**", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"tp", "[", 
         StyleBox["Ac",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], 
        RowBox[{"tp", "[", 
         StyleBox["Cc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}]},
       {
        RowBox[{"tp", "[", 
         StyleBox["Bc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}], 
        RowBox[{"tp", "[", 
         StyleBox["Dc",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 0]], "]"}]}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "**", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "0", "0"},
       {
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}], 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Y",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}], 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "0"}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "+", 
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], 
        RowBox[{
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]},
       {
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], 
        RowBox[{
         StyleBox["Y",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]},
       {"0", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]},
       {"0", "0"}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "**", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]},
       {
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "**", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "0", "0", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}
      }], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"G", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ac", ",", "Bc"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"Cc", ",", "Dc"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["Ac",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], 
      StyleBox["Bc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]]},
     {
      StyleBox["Cc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], 
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"EE", ",", 
     RowBox[{"{", 
      RowBox[{"FF", ",", "HH"}], "}"}]}], "}"}], "=", 
   RowBox[{"MatrixAffineFactorCoefficients", "[", 
    RowBox[{"BRLe", ",", "G", ",", 
     RowBox[{"{", 
      RowBox[{"X", ",", "Y"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "EE", "\[IndentingNewLine]", "FF", "\
\[IndentingNewLine]", "HH"}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{"tp", "[", 
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "]"}], 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {
      RowBox[{
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["A",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "0", "0", 
      RowBox[{
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {
      StyleBox["Cz",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "0", 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      StyleBox["Dzw",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]]},
     {
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{"tp", "[", 
       StyleBox["Dzw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "]"}], 
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], 
      RowBox[{
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]},
     {"0", 
      StyleBox["Dzu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]]},
     {"0", "0"}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0"},
     {
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "0", "0", 
      StyleBox["Dyw",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the Null spaces of EE and HH", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NF", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{"{", 
    RowBox[{"NF1", ",", "NF2", ",", "NF3", ",", "NF4"}], "}"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["NF1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox["NF2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], 
      StyleBox["NF3",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], 
      StyleBox["NF4",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NF", "**", "FF"}]], "Input"],

Cell[BoxData[
 RowBox[{
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["NF2",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], 
       StyleBox["NF3",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], 
       StyleBox["NF4",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]]}
     }], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "**", 
  TagBox[
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]},
      {
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]},
      {"0", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]},
      {"0", "0"}
     }], "\[NoBreak]", ")"}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqns", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"MatrixToList", "[", 
     RowBox[{"NCExpand", "[", 
      RowBox[{"NF", "**", "FF"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], "+", 
      RowBox[{
       StyleBox["NF2",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}]}]},
    {
     RowBox[{
      RowBox[{
       StyleBox["NF3",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "+", 
      RowBox[{
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]], "**", 
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "+", 
      RowBox[{
       StyleBox["NF2",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
   NonCommutativeMultiply[NF1, Y] + NonCommutativeMultiply[NF2, Y], 
    NonCommutativeMultiply[NF3, Dzu] + NonCommutativeMultiply[NF1, X, Bu] + 
    NonCommutativeMultiply[NF2, Y, Bu]}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rel1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Y", "**", 
      RowBox[{"Inv", "[", "Y", "]"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Inv", "[", "Y", "]"}], "**", "Y"}], "-", "1"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     StyleBox["Y",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["Y",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["Y",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"{", 
   RowBox[{"NF2", ",", "NF3"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NF2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   StyleBox["NF3",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"eqns", ",", "rel1"}], "]"}], ",", "unknowns", ",", "10"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       RowBox[{"Inv", "[", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Inv", "[", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      RowBox[{
       StyleBox["NF3",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["NF1",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 1]], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}], "+", 
       RowBox[{
        StyleBox["NF1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}]},
    {
     RowBox[{
      StyleBox["NF2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
      RowBox[{"-", 
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{NonCommutativeMultiply[Y, 
      Inv[Y]] -> 1, NonCommutativeMultiply[
      Inv[Y], Y] -> 1, 
    NonCommutativeMultiply[NF3, Dzu] -> -NonCommutativeMultiply[NF1, X, Bu] + 
     NonCommutativeMultiply[NF1, Y, Bu], NF2 -> -NF1}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hypothesis", "=", 
  RowBox[{"{", 
   RowBox[{"NF3", "\[Rule]", 
    RowBox[{"NF3t", "**", 
     RowBox[{"tp", "[", "Dzu", "]"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NF3",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
   RowBox[{
    StyleBox["NF3t",
     FontWeight->"Bold",
     FontColor->RGBColor[0, 0, 1]], "**", 
    RowBox[{"tp", "[", 
     StyleBox["Dzu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqnst", "=", 
  RowBox[{"eqns", "/.", "hypothesis"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     StyleBox["NF1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 1]], "**", 
     StyleBox["Y",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}], "+", 
    RowBox[{
     StyleBox["NF2",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 0, 1]], "**", 
     StyleBox["Y",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}]}], ",", 
   RowBox[{
    RowBox[{
     StyleBox["NF1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 1]], "**", 
     StyleBox["X",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     StyleBox["Bu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]]}], "+", 
    RowBox[{
     StyleBox["NF2",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 0, 1]], "**", 
     StyleBox["Y",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     StyleBox["Bu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]]}], "+", 
    RowBox[{
     StyleBox["NF3t",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 0, 1]], "**", 
     RowBox[{"tp", "[", 
      StyleBox["Dzu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
     StyleBox["Dzu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rel2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu", "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "]"}]}], "-", "1"}], 
    ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Inv", "[", 
       RowBox[{
        RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "]"}], "**", 
      RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "-", "1"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"tp", "[", 
      StyleBox["Dzu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
     StyleBox["Dzu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
     RowBox[{"tp", "[", 
      StyleBox["Dzu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
     StyleBox["Dzu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"{", 
   RowBox[{"NF2", ",", "NF3t"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NF2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   StyleBox["NF3t",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"eqnst", ",", "rel1", ",", "rel2"}], "]"}], ",", "unknowns", 
     ",", "10"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       RowBox[{"Inv", "[", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Inv", "[", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
       StyleBox["Y",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       RowBox[{"Inv", "[", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}], "]"}]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Inv", "[", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      StyleBox["NF2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
      RowBox[{"-", 
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]]}]}]},
    {
     RowBox[{
      StyleBox["NF3t",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["NF1",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 1]], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"Inv", "[", 
          RowBox[{
           RowBox[{"tp", "[", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}], "]"}]}]}], "+", 
       RowBox[{
        StyleBox["NF1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"Inv", "[", 
         RowBox[{
          RowBox[{"tp", "[", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]]}], "]"}]}]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{NonCommutativeMultiply[Y, 
      Inv[Y]] -> 1, NonCommutativeMultiply[
      Inv[Y], Y] -> 1, NonCommutativeMultiply[
      tp[Dzu], Dzu, 
      Inv[
       NonCommutativeMultiply[
        tp[Dzu], Dzu]]] -> 1, NonCommutativeMultiply[
      Inv[
       NonCommutativeMultiply[
        tp[Dzu], Dzu]], 
      tp[Dzu], Dzu] -> 1, NF2 -> -NF1, 
    NF3t -> -NonCommutativeMultiply[NF1, X, Bu, 
        Inv[
         NonCommutativeMultiply[
          tp[Dzu], Dzu]]] + NonCommutativeMultiply[NF1, Y, Bu, 
       Inv[
        NonCommutativeMultiply[
         tp[Dzu], Dzu]]]}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NFt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NF", "/.", "hypothesis"}], "/.", "solution"}], "/.", 
     RowBox[{"Inv", "\[Rule]", "inv"}]}], "//", "NCExpand"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NFt", "=", 
  RowBox[{"NCCollect", "[", 
   RowBox[{"NFt", ",", 
    RowBox[{"{", 
     RowBox[{"NF1", ",", 
      RowBox[{"Bu", "**", 
       RowBox[{"inv", "[", 
        RowBox[{
         RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "]"}], "**", 
       RowBox[{"tp", "[", "Dzu", "]"}]}]}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(NCCollect :: \\\"notsum\\\"\\) \
will be suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"More\
\[Ellipsis]\\\", ButtonStyle->\\\"RefGuideLinkText\\\", ButtonFrame->None, \
ButtonData:>\\\"General::stop\\\"]\\)\"\>"}]], "Message"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["NF1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]], 
      RowBox[{"-", 
       StyleBox["NF1",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 1]]}], 
      RowBox[{"-", 
       RowBox[{
        StyleBox["NF1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          StyleBox["Y",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]]}], ")"}], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{"tp", "[", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}]}], 
      StyleBox["NF4",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NFt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NF1", "\[Rule]", "0"}], ",", 
       RowBox[{"NF4", "\[Rule]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NF1", "\[Rule]", "1"}], ",", 
       RowBox[{"NF4", "\[Rule]", "0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NFperp", "=", 
  RowBox[{"MatrixFlatten", "[", 
   RowBox[{"Matrix", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"List", ",", "%"}], "]"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1"},
     {"1", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          StyleBox["Y",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]]}], ")"}], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{"tp", "[", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "0"}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NFt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NF1", "\[Rule]", "0"}], ",", 
       RowBox[{"NF4", "\[Rule]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NF1", "\[Rule]", 
        RowBox[{"inv", "[", 
         RowBox[{"X", "-", "Y"}], "]"}]}], ",", 
       RowBox[{"NF4", "\[Rule]", "0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NFperp", "=", 
  RowBox[{"MatrixFlatten", "[", 
   RowBox[{"Matrix", "[", 
    RowBox[{"Map", "[", 
     RowBox[{"List", ",", "%"}], "]"}], "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "1"},
     {
      RowBox[{"inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "]"}], 
      RowBox[{"-", 
       RowBox[{"inv", "[", 
        RowBox[{
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "-", 
         StyleBox["Y",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}], "]"}]}], 
      RowBox[{"-", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{"tp", "[", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "0"}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NH", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", "NH1", "}"}], ",", 
    RowBox[{"{", "NH2", "}"}], ",", 
    RowBox[{"{", "NH3", "}"}], ",", 
    RowBox[{"{", "NH4", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["NH1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]},
     {
      StyleBox["NH2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]]},
     {
      StyleBox["NH3",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]},
     {
      StyleBox["NH4",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqns", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"MatrixToList", "[", 
    RowBox[{"NCExpand", "[", 
     RowBox[{"HH", "**", "NH"}], "]"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NH2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   RowBox[{
    RowBox[{
     StyleBox["Cy",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["NH1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 1]]}], "+", 
    RowBox[{
     StyleBox["Dyw",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["NH4",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 0, 1]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"{", 
   RowBox[{"NH2", ",", "NH4"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NH2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   StyleBox["NH4",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NCEliminate", "[", 
    RowBox[{"eqns", ",", "unknowns", ",", "10"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      StyleBox["NH2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", "0"}]},
    {
     RowBox[{
      RowBox[{
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["NH4",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 0, 1]]}], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["NH1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]]}]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
   NH2 -> 0, 
    NonCommutativeMultiply[Dyw, NH4] -> -NonCommutativeMultiply[Cy, NH1]}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hypothesis", "=", 
  RowBox[{"{", 
   RowBox[{"NH4", "\[Rule]", 
    RowBox[{
     RowBox[{"tp", "[", "Dyw", "]"}], "**", "NH4t"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NH4",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
   RowBox[{
    RowBox[{"tp", "[", 
     StyleBox["Dyw",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
    StyleBox["NH4t",
     FontWeight->"Bold",
     FontColor->RGBColor[0, 0, 1]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqnst", "=", 
  RowBox[{"eqns", "/.", "hypothesis"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NH2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   RowBox[{
    RowBox[{
     StyleBox["Cy",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["NH1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 1]]}], "+", 
    RowBox[{
     StyleBox["Dyw",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     RowBox[{"tp", "[", 
      StyleBox["Dyw",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
     StyleBox["NH4t",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 0, 1]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rel2", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"Dyw", "**", 
      RowBox[{"tp", "[", "Dyw", "]"}], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{"Dyw", "**", 
        RowBox[{"tp", "[", "Dyw", "]"}]}], "]"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Inv", "[", 
       RowBox[{"Dyw", "**", 
        RowBox[{"tp", "[", "Dyw", "]"}]}], "]"}], "**", "Dyw", "**", 
      RowBox[{"tp", "[", "Dyw", "]"}]}], "-", "1"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     StyleBox["Dyw",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     RowBox[{"tp", "[", 
      StyleBox["Dyw",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
     StyleBox["Dyw",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     RowBox[{"tp", "[", 
      StyleBox["Dyw",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"{", 
   RowBox[{"NH2", ",", "NH4t"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["NH2",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]], ",", 
   StyleBox["NH4t",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 0, 1]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"solution", "=", 
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"Join", "[", 
      RowBox[{"eqnst", ",", "rel2"}], "]"}], ",", "unknowns", ",", "10"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ColumnForm"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{
      StyleBox["NH2",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", "0"}]},
    {
     RowBox[{
      RowBox[{
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
       RowBox[{"Inv", "[", 
        RowBox[{
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}]}], "\[Rule]", 
      "1"}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"Inv", "[", 
        RowBox[{
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
       StyleBox["Dyw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       RowBox[{"tp", "[", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], "\[Rule]", "1"}]},
    {
     RowBox[{
      StyleBox["NH4t",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]], "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"Inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["NH1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]]}]}]}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{NH2 -> 0, NonCommutativeMultiply[Dyw, 
      tp[Dyw], 
      Inv[
       NonCommutativeMultiply[Dyw, 
        tp[Dyw]]]] -> 1, NonCommutativeMultiply[
      Inv[
       NonCommutativeMultiply[Dyw, 
        tp[Dyw]]], Dyw, 
      tp[Dyw]] -> 1, NH4t -> -NonCommutativeMultiply[
       Inv[
        NonCommutativeMultiply[Dyw, 
         tp[Dyw]]], Cy, NH1]}],
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NHt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"NH", "/.", "hypothesis"}], "/.", "solution"}], "/.", 
   RowBox[{"Inv", "\[Rule]", "inv"}]}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["NH1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]},
     {"0"},
     {
      StyleBox["NH3",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 1]]},
     {
      RowBox[{"-", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["NH1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 1]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NHt", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NH1", "\[Rule]", "0"}], ",", 
       RowBox[{"NH3", "\[Rule]", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"NH1", "\[Rule]", "1"}], ",", 
       RowBox[{"NH3", "\[Rule]", "0"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"NHperp", "=", 
  RowBox[{"MatrixFlatten", "[", 
   RowBox[{"Matrix", "[", "%", "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1"},
     {"0", "0"},
     {"1", "0"},
     {"0", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing the LMI", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"NCExpand", "[", 
   RowBox[{
    RowBox[{"NFperp", "**", "EE", "**", 
     RowBox[{"tp", "[", "NFperp", "]"}]}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", "X", "]"}], "\[Rule]", "X"}], ",", 
      RowBox[{
       RowBox[{"tp", "[", "Y", "]"}], "\[Rule]", "Y"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"Bw", ",", 
      RowBox[{"tp", "[", "Bw", "]"}], ",", "Bu", ",", 
      RowBox[{"tp", "[", "Bu", "]"}], ",", "A", ",", 
      RowBox[{"tp", "[", "A", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"inv", "[", 
     RowBox[{"X", "-", "Y"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"Bu", "**", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "]"}], "**", 
     RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu", "**", 
     RowBox[{"inv", "[", 
      RowBox[{
       RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "]"}], "**", 
     RowBox[{"tp", "[", "Bu", "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"LMI2", "=", 
  RowBox[{"%", "/.", 
   RowBox[{
    RowBox[{"inv", "[", 
     RowBox[{"X", "-", "Y"}], "]"}], "\[Rule]", "Z"}]}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Dzw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           RowBox[{"tp", "[", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}]},
     {
      RowBox[{
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "-", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          RowBox[{"tp", "[", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"tp", "[", 
             StyleBox["Cz",
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "**", 
            RowBox[{"inv", "[", 
             RowBox[{
              RowBox[{"tp", "[", 
               StyleBox["Dzu",
                FontWeight->"Bold",
                FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
              StyleBox["Dzu",
               FontWeight->"Bold",
               FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
            RowBox[{"tp", "[", 
             StyleBox["Bu",
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]], "]"}]}], "-", 
           RowBox[{"tp", "[", 
            StyleBox["A",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}]}], ")"}]}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          StyleBox["A",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "-", 
          RowBox[{
           StyleBox["Bu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           RowBox[{"inv", "[", 
            RowBox[{
             RowBox[{"tp", "[", 
              StyleBox["Dzu",
               FontWeight->"Bold",
               FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
             StyleBox["Dzu",
              FontWeight->"Bold",
              FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
           RowBox[{"tp", "[", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
           StyleBox["Cz",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}]}], ")"}], "**", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], " ", 
        RowBox[{
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           RowBox[{"tp", "[", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dzu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           RowBox[{"tp", "[", 
            StyleBox["Dzu",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
           StyleBox["Dzu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LMI1", "=", 
  RowBox[{"NCExpand", "[", 
   RowBox[{
    RowBox[{"tp", "[", "NHperp", "]"}], "**", "EE", "**", "NHperp"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "-", 
       RowBox[{
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Cy",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           RowBox[{"tp", "[", 
            StyleBox["Dyw",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dzw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], 
      RowBox[{
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "-", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        RowBox[{"inv", "[", 
         RowBox[{
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "**", 
          RowBox[{"tp", "[", 
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], " ", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Cy",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           RowBox[{"tp", "[", 
            StyleBox["Dyw",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dyw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         RowBox[{"inv", "[", 
          RowBox[{
           StyleBox["Dyw",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           RowBox[{"tp", "[", 
            StyleBox["Dyw",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "]"}]}], "]"}], "**", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Using orthogonality (this is what goes in the paper!)", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Substitute", "[", 
  RowBox[{"LMI2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", "Cz", "]"}], "**", "Dzu"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", "Dzu", "]"}], "**", "Cz"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"tp", "[", "Dzu", "]"}], "**", "Dzu"}], "\[Rule]", "1"}]}], 
    "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Dzw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}]},
     {
      RowBox[{
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "-", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dzu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], " ", 
        RowBox[{
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Bu",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "+", 
       RowBox[{
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Substitute", "[", 
  RowBox[{"LMI1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Dyw", "**", 
       RowBox[{"tp", "[", "Bw", "]"}]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Bw", "**", 
       RowBox[{"tp", "[", "Dyw", "]"}]}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Dyw", "**", 
       RowBox[{"tp", "[", "Dyw", "]"}]}], "\[Rule]", "1"}]}], "}"}]}], 
  "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       StyleBox["mu",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "-", 
       RowBox[{
        StyleBox["Dzw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Cy",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Dyw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["Dzw",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}]}]}], "+", 
       RowBox[{"tp", "[", 
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "]"}]}], 
      RowBox[{
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        RowBox[{"tp", "[", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["mu",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], " ", 
        RowBox[{
         RowBox[{"tp", "[", 
          StyleBox["Cy",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "]"}], "**", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Change of variables", "Section"],

Cell[CellGroupData[{

Cell["Idea for a similarity transformation on closed loop matrices", \
"Subsection"],

Cell[TextData[{
 "After applying the similarity transformation these matrices look like:\n\n\t\
(AclT, BclT, CclT, DclT) = (T Acl ",
 Cell[BoxData[
  TagBox[
   SuperscriptBox["T", "\"\<-1\>\""],
   HoldForm]]],
 "T Xcl ",
 Cell[BoxData[
  TagBox[
   SuperscriptBox["T", "\"\<T\>\""],
   HoldForm]]],
 ",T Bcl, Ccl ",
 Cell[BoxData[
  SuperscriptBox["T", "\"\<-1\>\""]]],
 "T Xcl ",
 Cell[BoxData[
  TagBox[
   SuperscriptBox["T", "\"\<T\>\""],
   HoldForm]]],
 ", Dcl)"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Tt", "=", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "U"}], ",", "U"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"inv", "[", "Tt", "]"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {
      RowBox[{"-", 
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}], 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {"1", 
      RowBox[{"inv", "[", 
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Interpretation:", "Subsection"],

Cell["The original state vector", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xcl", " ", "=", " ", 
  RowBox[{"Matrix", "[", 
   RowBox[{
    RowBox[{"{", "x", "}"}], ",", 
    RowBox[{"{", "xc", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["x",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]]},
     {
      StyleBox["xc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell["gets transformed into", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xclT", " ", "=", " ", 
  RowBox[{"NCCollect", "[", 
   RowBox[{
    RowBox[{"NCExpand", "[", 
     RowBox[{"Tt", "**", "xcl"}], "]"}], ",", "U"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["x",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 0, 1]]},
     {
      RowBox[{"-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["x",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 0, 1]], "-", 
          StyleBox["xc",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 0, 1]]}], ")"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell["\<\
That is, the transformed state vector is the \"plant state \" plus a linear \
transformation of the \"estimation error\"!\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the transformed closed loop matrices", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"AclT", "=", 
  RowBox[{"NCExpand", "[", 
   RowBox[{"Tt", "**", "Acl", "**", 
    RowBox[{"inv", "[", "Tt", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"BclT", "=", 
  RowBox[{"NCExpand", "[", 
   RowBox[{"Tt", "**", "Bcl"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"CclT", "=", 
  RowBox[{"NCExpand", "[", 
   RowBox[{"Ccl", "**", 
    RowBox[{"inv", "[", "Tt", "]"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       StyleBox["A",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       StyleBox["Bu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["Cc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]], "**", 
       RowBox[{"inv", "[", 
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bw",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Cc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]]}], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}], 
      RowBox[{
       StyleBox["Dzu",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["Cc",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 0]], "**", 
       RowBox[{"inv", "[", 
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compute the transformed Lyapunov matrix", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"XclT", "=", 
  RowBox[{"NCExpand", "[", 
   RowBox[{"Tt", "**", "Pcl", "**", 
    RowBox[{"tp", "[", "Tt", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         RowBox[{"tp", "[", 
          StyleBox["U",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}]}]}], "+", 
       RowBox[{
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Y",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Apply strategy on T Acl inv[T]", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Y", "\[Rule]", 
   RowBox[{"X", "-", 
    RowBox[{"Inv", "[", "Z", "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox["Y",
   FontWeight->"Bold",
   FontColor->RGBColor[0, 1, 1]], "\[Rule]", 
  RowBox[{
   StyleBox["X",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 1, 1]], "-", 
   RowBox[{"Inv", "[", 
    StyleBox["Z",
     FontWeight->"Bold",
     FontColor->RGBColor[0, 1, 1]], "]"}]}]}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"NCExpand", "[", 
    RowBox[{"AclT", " ", "**", " ", "XclT"}], "]"}], "//.", 
   RowBox[{"{", 
    RowBox[{"sol0", ",", 
     RowBox[{"Inv", "\[Rule]", "inv"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exp1", "=", 
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", "Bu", "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           StyleBox["Cc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           RowBox[{"(", 
            RowBox[{
             StyleBox["X",
              FontWeight->"Bold",
              FontColor->RGBColor[0, 1, 1]], "-", 
             RowBox[{"inv", "[", 
              StyleBox["Z",
               FontWeight->"Bold",
               FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}], "+", 
          RowBox[{
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           StyleBox["X",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["Bu",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            StyleBox["Dc",
             FontWeight->"Bold",
             FontColor->RGBColor[0, 1, 0]], "**", 
            StyleBox["Cy",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "**", 
            StyleBox["X",
             FontWeight->"Bold",
             FontColor->RGBColor[0, 1, 1]], "**", 
            RowBox[{"tp", "[", 
             StyleBox["U",
              FontWeight->"Bold",
              FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
           RowBox[{
            StyleBox["Dc",
             FontWeight->"Bold",
             FontColor->RGBColor[0, 1, 0]], "**", 
            StyleBox["Cy",
             FontWeight->"Bold",
             FontColor->RGBColor[1, 0, 0]], "**", 
            RowBox[{"(", 
             RowBox[{
              StyleBox["X",
               FontWeight->"Bold",
               FontColor->RGBColor[0, 1, 1]], "-", 
              RowBox[{"inv", "[", 
               StyleBox["Z",
                FontWeight->"Bold",
                FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
            RowBox[{"tp", "[", 
             StyleBox["U",
              FontWeight->"Bold",
              FontColor->RGBColor[0, 1, 1]], "]"}]}]}], ")"}]}]}], "-", 
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "+", 
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          RowBox[{"inv", "[", 
           StyleBox["Z",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          RowBox[{"inv", "[", 
           StyleBox["Z",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           StyleBox["Cc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           RowBox[{"(", 
            RowBox[{
             StyleBox["X",
              FontWeight->"Bold",
              FontColor->RGBColor[0, 1, 1]], "-", 
             RowBox[{"inv", "[", 
              StyleBox["Z",
               FontWeight->"Bold",
               FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}], "+", 
          RowBox[{
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           StyleBox["X",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]]}]}], ")"}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           StyleBox["X",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "**", 
           RowBox[{"tp", "[", 
            StyleBox["U",
             FontWeight->"Bold",
             FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
          RowBox[{
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           RowBox[{"(", 
            RowBox[{
             StyleBox["X",
              FontWeight->"Bold",
              FontColor->RGBColor[0, 1, 1]], "-", 
             RowBox[{"inv", "[", 
              StyleBox["Z",
               FontWeight->"Bold",
               FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
           RowBox[{"tp", "[", 
            StyleBox["U",
             FontWeight->"Bold",
             FontColor->RGBColor[0, 1, 1]], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          RowBox[{"inv", "[", 
           StyleBox["Z",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          RowBox[{"inv", "[", 
           StyleBox["Z",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol1", "=", 
  RowBox[{
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cc", "**", 
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], ")"}]}], "+", 
        RowBox[{"Dc", "**", "Cy", "**", "X"}], "-", "N1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], ")"}], "**", 
         RowBox[{"Inv", "[", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], "]"}]}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Inv", "[", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], "]"}], "**", 
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], ")"}]}], "-", "1"}]}], "}"}], 
     ",", 
     RowBox[{"{", "Cc", "}"}], ",", "10"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"{", "3", "}"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["Cc",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 1, 0]], "\[Rule]", 
   RowBox[{
    RowBox[{
     StyleBox["N1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0.500008, 0]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "-", 
    RowBox[{
     StyleBox["Dc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "**", 
     StyleBox["Cy",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["X",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exp1", "/.", "sol1"}], "//.", 
    RowBox[{"Inv", "\[Rule]", "inv"}]}], "//", "NCExpand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exp2", "=", 
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", "Cy", "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          StyleBox["Z",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["U",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}]}]}], "-", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["X",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           StyleBox["U",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "**", 
           StyleBox["Bc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]]}], "-", 
          RowBox[{
           StyleBox["U",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "**", 
           StyleBox["Bu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]]}]}], ")"}], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol2", "=", 
  RowBox[{
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"U", "**", "Bc"}], "-", 
        RowBox[{"U", "**", "Bu", "**", "Dc"}], "-", "N2"}], ",", 
       RowBox[{
        RowBox[{"U", "**", 
         RowBox[{"Inv", "[", "U", "]"}]}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Inv", "[", "U", "]"}], "**", "U"}], "-", "1"}]}], "}"}], 
     ",", 
     RowBox[{"{", "Bc", "}"}], ",", "10"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"{", "3", "}"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["Bc",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 1, 0]], "\[Rule]", 
   RowBox[{
    RowBox[{
     StyleBox["Bu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["Dc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]]}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["N2",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0.500008, 0]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exp2", "/.", "sol2"}], "//.", 
    RowBox[{"Inv", "\[Rule]", "inv"}]}], "//", "NCExpand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exp3", "=", 
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", "Ac", "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["A",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          StyleBox["Z",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["U",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}]}]}], "-", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]},
     {
      RowBox[{
       RowBox[{
        StyleBox["N2",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Ac",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        RowBox[{"(", 
         RowBox[{
          StyleBox["X",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "-", 
          RowBox[{"inv", "[", 
           StyleBox["Z",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}], "-", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         StyleBox["N2",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0.500008, 0]], "**", 
         StyleBox["Cy",
          FontWeight->"Bold",
          FontColor->RGBColor[1, 0, 0]], "**", 
         RowBox[{"inv", "[", 
          StyleBox["Z",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
         RowBox[{"tp", "[", 
          StyleBox["U",
           FontWeight->"Bold",
           FontColor->RGBColor[0, 1, 1]], "]"}]}]}], "+", 
       RowBox[{
        StyleBox["U",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol3", "=", 
  RowBox[{
   RowBox[{"NCEliminate", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"N2", "**", 
         StyleBox["Cy",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["X",
          FontColor->RGBColor[0, 1, 1]]}], "-", 
        RowBox[{
         StyleBox["U",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["A",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["X",
          FontColor->RGBColor[0, 1, 1]]}], "+", 
        RowBox[{
         StyleBox["U",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Ac",
          FontColor->RGBColor[0, 1, 0]], "**", 
         RowBox[{"(", 
          RowBox[{
           StyleBox["X",
            FontColor->RGBColor[0, 1, 1]], "-", 
           RowBox[{"Inv", "[", 
            StyleBox["Z",
             FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}], "-", 
        RowBox[{
         StyleBox["U",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontColor->RGBColor[1, 0, 0]], "**", "N1"}], "+", 
        RowBox[{
         StyleBox["U",
          FontColor->RGBColor[0, 1, 1]], "**", 
         StyleBox["Bu",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["Dc",
          FontColor->RGBColor[0, 1, 0]], "**", 
         StyleBox["Cy",
          FontColor->RGBColor[1, 0, 0]], "**", 
         StyleBox["X",
          FontColor->RGBColor[0, 1, 1]]}], 
        StyleBox["-",
         FontColor->RGBColor[0, 1, 1]], 
        StyleBox["N3",
         FontColor->RGBColor[0, 1, 1]]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Inv", "[", "U", "]"}], "**", "U"}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{"U", "**", 
         RowBox[{"Inv", "[", "U", "]"}]}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Inv", "[", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], "]"}], "**", 
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], ")"}]}], "-", "1"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], ")"}], "**", 
         RowBox[{"Inv", "[", 
          RowBox[{"X", "-", 
           RowBox[{"Inv", "[", "Z", "]"}]}], "]"}]}], "-", "1"}]}], "}"}], 
     ",", 
     RowBox[{"{", "Ac", "}"}], ",", "10"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"{", "5", "}"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["Ac",
    FontWeight->"Bold",
    FontColor->RGBColor[0, 1, 0]], "\[Rule]", 
   RowBox[{
    RowBox[{
     StyleBox["A",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["X",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
    RowBox[{
     StyleBox["Bu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["N1",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0.500008, 0]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["N3",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0.500008, 0]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "-", 
    RowBox[{
     StyleBox["Bu",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["Dc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "**", 
     StyleBox["Cy",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["X",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["N2",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0.500008, 0]], "**", 
     StyleBox["Cy",
      FontWeight->"Bold",
      FontColor->RGBColor[1, 0, 0]], "**", 
     StyleBox["X",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"exp3", "/.", "sol3"}], "//.", 
    RowBox[{"Inv", "\[Rule]", "inv"}]}], "//", "NCExpand"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"exp4", "=", 
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"tp", "[", "U", "]"}], ",", 
      RowBox[{"inv", "[", "Z", "]"}]}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NCCollect", "::", "\<\"notsum\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Expression is not a sum of terms.\"\>"}]], "Message"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}]}], 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          StyleBox["A",
           FontWeight->"Bold",
           FontColor->RGBColor[1, 0, 0]], "+", 
          RowBox[{
           StyleBox["Bu",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]], "**", 
           StyleBox["Dc",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}]}], ")"}], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]},
     {
      StyleBox["N3",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           StyleBox["N2",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0.500008, 0]], "**", 
           StyleBox["Cy",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}], "-", 
          RowBox[{
           StyleBox["U",
            FontWeight->"Bold",
            FontColor->RGBColor[0, 1, 1]], "**", 
           StyleBox["A",
            FontWeight->"Bold",
            FontColor->RGBColor[1, 0, 0]]}]}], ")"}], "**", 
        RowBox[{"inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
        RowBox[{"tp", "[", 
         StyleBox["U",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Everything is linear if U=-Z", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol4", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"U", "\[Rule]", 
     RowBox[{"-", "Z"}]}], ",", 
    RowBox[{
     RowBox[{"tp", "[", "Z", "]"}], "\[Rule]", "Z"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    StyleBox["U",
     FontWeight->"Bold",
     FontColor->RGBColor[0, 1, 1]], "\[Rule]", 
    RowBox[{"-", 
     StyleBox["Z",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}]}], ",", 
   RowBox[{
    RowBox[{"tp", "[", 
     StyleBox["Z",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "]"}], "\[Rule]", 
    StyleBox["Z",
     FontWeight->"Bold",
     FontColor->RGBColor[0, 1, 1]]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"exp4", "//.", "sol4"}], "//", "NCExpand"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}]}], 
      RowBox[{
       StyleBox["A",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      StyleBox["N3",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], 
      RowBox[{
       RowBox[{
        StyleBox["N2",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["A",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check other matrices", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Substitute", "[", 
    RowBox[{
     RowBox[{"CclT", "**", "XclT"}], ",", 
     RowBox[{"{", 
      RowBox[{"sol0", ",", "sol1", ",", "sol2", ",", "sol3", ",", "sol4"}], 
      "}"}]}], "]"}], "//", "NCExpand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NCCollect", "[", 
   RowBox[{"%", ",", 
    RowBox[{"{", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Substitute", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Inv", "\[Rule]", "inv"}]}], "]"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        StyleBox["Cz",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]]}], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["N1",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]]}]}], 
      RowBox[{
       StyleBox["Cz",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Dzu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Cy",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Substitute", "[", 
    RowBox[{"BclT", ",", 
     RowBox[{"{", 
      RowBox[{"sol0", ",", "sol1", ",", "sol2", ",", "sol3", ",", "sol4"}], 
      "}"}]}], "]"}], "//", "NCExpand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Substitute", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Inv", "\[Rule]", "inv"}]}], "]"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       StyleBox["Bw",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "+", 
       RowBox[{
        StyleBox["Bu",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]], "**", 
        StyleBox["Dc",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]},
     {
      RowBox[{
       RowBox[{
        StyleBox["N2",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0.500008, 0]], "**", 
        StyleBox["Dyw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}], "+", 
       RowBox[{
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "**", 
        StyleBox["Bw",
         FontWeight->"Bold",
         FontColor->RGBColor[1, 0, 0]]}]}]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Substitute", "[", 
    RowBox[{"XclT", ",", 
     RowBox[{"{", 
      RowBox[{"sol0", ",", "sol1", ",", "sol2", ",", "sol3", ",", "sol4"}], 
      "}"}]}], "]"}], "//", "NCExpand"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Substitute", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Inv", "\[Rule]", "inv"}]}], "]"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "1"},
     {"1", 
      StyleBox["Z",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}
    }], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Verify solution", "Subsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqns", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sol1", ",", "sol1", ",", "sol2", ",", "sol3"}], "}"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a_", "\[Rule]", "b_"}], ")"}], "\[Rule]", 
    RowBox[{"a", " ", "-", " ", "b"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     StyleBox["Cc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "-", 
     RowBox[{
      StyleBox["N1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
     RowBox[{
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["Cc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "-", 
     RowBox[{
      StyleBox["N1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
     RowBox[{
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["Bc",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "-", 
     RowBox[{
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]]}], "-", 
     RowBox[{
      RowBox[{"Inv", "[", 
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
      StyleBox["N2",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     StyleBox["Ac",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 0]], "-", 
     RowBox[{
      StyleBox["A",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "-", 
     RowBox[{
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["N1",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"Inv", "[", 
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
      StyleBox["N3",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
     RowBox[{
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"Inv", "[", 
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
      StyleBox["N2",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0.500008, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rels", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Inv", "[", 
       RowBox[{"X", "-", 
        RowBox[{"Inv", "[", "Z", "]"}]}], "]"}], "**", 
      RowBox[{"(", 
       RowBox[{"X", "-", 
        RowBox[{"Inv", "[", "Z", "]"}]}], ")"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"X", "-", 
        RowBox[{"Inv", "[", "Z", "]"}]}], ")"}], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{"X", "-", 
        RowBox[{"Inv", "[", "Z", "]"}]}], "]"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{"U", "**", 
      RowBox[{"Inv", "[", "U", "]"}]}], "-", "1"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Inv", "[", "U", "]"}], "**", "U"}], "-", "1"}]}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}], "**", 
     RowBox[{"(", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], ")"}], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     StyleBox["U",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["U",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"unknowns", "=", 
  RowBox[{"{", 
   RowBox[{"N1", ",", "N2", ",", "N3"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   StyleBox["N1",
    FontWeight->"Bold",
    FontColor->RGBColor[1, 0.500008, 0]], ",", 
   StyleBox["N2",
    FontWeight->"Bold",
    FontColor->RGBColor[1, 0.500008, 0]], ",", 
   StyleBox["N3",
    FontWeight->"Bold",
    FontColor->RGBColor[1, 0.500008, 0]]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCEliminate", "[", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"eqns", ",", "rels"}], "]"}], ",", "unknowns", ",", "10"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}], "**", 
     RowBox[{"Inv", "[", 
      StyleBox["Z",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["Z",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     RowBox[{"Inv", "[", 
      RowBox[{
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "-", 
       RowBox[{"Inv", "[", 
        StyleBox["Z",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}], "\[Rule]", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      RowBox[{"Inv", "[", 
       RowBox[{
        StyleBox["X",
         FontWeight->"Bold",
         FontColor->RGBColor[0, 1, 1]], "-", 
        RowBox[{"Inv", "[", 
         StyleBox["Z",
          FontWeight->"Bold",
          FontColor->RGBColor[0, 1, 1]], "]"}]}], "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     StyleBox["U",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]], "**", 
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Inv", "[", 
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "]"}], "**", 
     StyleBox["U",
      FontWeight->"Bold",
      FontColor->RGBColor[0, 1, 1]]}], "\[Rule]", "1"}], ",", 
   RowBox[{
    StyleBox["N2",
     FontWeight->"Bold",
     FontColor->RGBColor[1, 0.500008, 0]], "\[Rule]", 
    RowBox[{
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]]}], "-", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]]}]}]}], ",", 
   RowBox[{
    StyleBox["N1",
     FontWeight->"Bold",
     FontColor->RGBColor[1, 0.500008, 0]], "\[Rule]", 
    RowBox[{
     RowBox[{
      StyleBox["Cc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}], "-", 
     RowBox[{
      StyleBox["Cc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      RowBox[{"Inv", "[", 
       StyleBox["Z",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}]}], "+", 
     RowBox[{
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}]}]}], ",", 
   RowBox[{
    StyleBox["N3",
     FontWeight->"Bold",
     FontColor->RGBColor[1, 0.500008, 0]], "\[Rule]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       StyleBox["U",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "**", 
       StyleBox["A",
        FontWeight->"Bold",
        FontColor->RGBColor[1, 0, 0]], "**", 
       StyleBox["X",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]]}]}], "+", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Ac",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}], "-", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Ac",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      RowBox[{"Inv", "[", 
       StyleBox["Z",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}]}], "+", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}], "-", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Cc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}], "+", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Cc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      RowBox[{"Inv", "[", 
       StyleBox["Z",
        FontWeight->"Bold",
        FontColor->RGBColor[0, 1, 1]], "]"}]}], "-", 
     RowBox[{
      StyleBox["U",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]], "**", 
      StyleBox["Bu",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["Dc",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 0]], "**", 
      StyleBox["Cy",
       FontWeight->"Bold",
       FontColor->RGBColor[1, 0, 0]], "**", 
      StyleBox["X",
       FontWeight->"Bold",
       FontColor->RGBColor[0, 1, 1]]}]}]}]}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
ScreenStyleEnvironment->"Working",
WindowSize->{1269, 669},
WindowMargins->{{3, Automatic}, {Automatic, 0}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PostScriptOutputFile":>FrontEnd`FileName[{$RootDirectory, "home", "mauricio",
    "tex", "papers", "symbolic", "mat"}, "paper.nb.ps", CharacterEncoding -> 
  "iso8859-1"]},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification->1,
FrontEndVersion->"10.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (July 29, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 36, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[641, 26, 170, 3, 46, "Input"],
Cell[CellGroupData[{
Cell[836, 33, 185, 3, 22, "Print"],
Cell[1024, 38, 274, 6, 21, "Print"],
Cell[1301, 46, 413, 9, 22, "Print"]
}, Open  ]]
}, Open  ]],
Cell[1741, 59, 215, 4, 28, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1993, 68, 52, 0, 44, "Subsection"],
Cell[2048, 70, 29, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[2102, 74, 592, 15, 46, "Input"],
Cell[2697, 91, 744, 20, 63, "Output"]
}, Open  ]],
Cell[3456, 114, 30, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[3511, 118, 438, 9, 46, "Input"],
Cell[3952, 129, 286, 7, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4275, 141, 376, 8, 46, "Input"],
Cell[4654, 151, 198, 4, 28, "Output"]
}, Open  ]],
Cell[4867, 158, 33, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[4925, 162, 449, 12, 46, "Input"],
Cell[5377, 176, 700, 19, 45, "Output"]
}, Open  ]],
Cell[6092, 198, 34, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[6151, 202, 440, 9, 46, "Input"],
Cell[6594, 213, 224, 6, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6855, 224, 216, 5, 28, "Input"],
Cell[7074, 231, 163, 4, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[7286, 241, 66, 0, 44, "Subsection"],
Cell[7355, 243, 54, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[7434, 247, 312, 8, 28, "Input"],
Cell[7749, 257, 941, 36, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8727, 298, 266, 7, 28, "Input"],
Cell[8996, 307, 547, 21, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9580, 333, 228, 5, 28, "Input"],
Cell[9811, 340, 1397, 55, 30, "Output"]
}, Open  ]],
Cell[11223, 398, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[11283, 402, 314, 9, 46, "Input"],
Cell[11600, 413, 309, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11946, 427, 332, 9, 28, "Input"],
Cell[12281, 438, 1736, 63, 97, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14054, 506, 376, 10, 28, "Input"],
Cell[14433, 518, 204, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14674, 528, 170, 3, 28, "Input"],
Cell[14847, 533, 5398, 168, 97, "Output"]
}, Open  ]],
Cell[20260, 704, 56, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[20341, 708, 268, 7, 46, "Input"],
Cell[20612, 717, 6919, 219, 98, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27580, 942, 57, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[27662, 946, 433, 12, 28, "Input"],
Cell[28098, 960, 3304, 113, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31439, 1078, 428, 13, 46, "Input"],
Cell[31870, 1093, 2764, 95, 63, "Output"]
}, Open  ]],
Cell[34649, 1191, 971, 34, 80, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35657, 1230, 41, 0, 64, "Section"],
Cell[CellGroupData[{
Cell[35723, 1234, 738, 22, 46, "Input"],
Cell[36464, 1258, 1753, 61, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38254, 1324, 210, 7, 28, "Input"],
Cell[38467, 1333, 511, 19, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39015, 1357, 432, 11, 28, "Input"],
Cell[39450, 1370, 13741, 443, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53240, 1819, 30, 0, 64, "Section"],
Cell[CellGroupData[{
Cell[53295, 1823, 204, 6, 28, "Input"],
Cell[53502, 1831, 6759, 232, 160, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60298, 2068, 212, 7, 28, "Input"],
Cell[60513, 2077, 515, 19, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61065, 2101, 415, 12, 80, "Input"],
Cell[61483, 2115, 2639, 92, 81, "Output"],
Cell[64125, 2209, 860, 32, 79, "Output"],
Cell[64988, 2243, 372, 13, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65397, 2261, 60, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[65482, 2265, 164, 5, 28, "Input"],
Cell[65649, 2272, 512, 18, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66198, 2295, 52, 1, 28, "Input"],
Cell[66253, 2298, 1417, 51, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67707, 2354, 279, 8, 46, "Input"],
Cell[67989, 2364, 1717, 56, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69743, 2425, 275, 10, 28, "Input"],
Cell[70021, 2437, 597, 22, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70655, 2464, 107, 3, 28, "Input"],
Cell[70765, 2469, 221, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71023, 2482, 290, 8, 46, "Input"],
Cell[71316, 2492, 2189, 72, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73542, 2569, 176, 5, 28, "Input"],
Cell[73721, 2576, 367, 13, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74125, 2594, 89, 2, 28, "Input"],
Cell[74217, 2598, 1360, 49, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75614, 2652, 512, 17, 28, "Input"],
Cell[76129, 2671, 1165, 40, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77331, 2716, 108, 3, 28, "Input"],
Cell[77442, 2721, 222, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77701, 2734, 305, 8, 46, "Input"],
Cell[78009, 2744, 4199, 137, 115, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82245, 2886, 588, 18, 46, "Input"],
Cell[82836, 2906, 157, 4, 20, "Message"],
Cell[82996, 2912, 157, 4, 20, "Message"],
Cell[83156, 2918, 157, 4, 20, "Message"],
Cell[83316, 2924, 364, 7, 22, "Message"],
Cell[83683, 2933, 1384, 45, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85104, 2983, 564, 18, 46, "Input"],
Cell[85671, 3003, 1059, 34, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86767, 3042, 630, 20, 46, "Input"],
Cell[87400, 3064, 1283, 42, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88720, 3111, 235, 7, 28, "Input"],
Cell[88958, 3120, 533, 21, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89528, 3146, 192, 5, 28, "Input"],
Cell[89723, 3153, 542, 20, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90302, 3178, 107, 3, 28, "Input"],
Cell[90412, 3183, 221, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90670, 3196, 224, 6, 46, "Input"],
Cell[90897, 3204, 948, 32, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[91882, 3241, 176, 5, 28, "Input"],
Cell[92061, 3248, 367, 13, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92465, 3266, 89, 2, 28, "Input"],
Cell[92557, 3270, 669, 24, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93263, 3299, 503, 15, 28, "Input"],
Cell[93769, 3316, 1165, 40, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94971, 3361, 108, 3, 28, "Input"],
Cell[95082, 3366, 222, 8, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95341, 3379, 291, 8, 46, "Input"],
Cell[95635, 3389, 2572, 85, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98244, 3479, 177, 5, 28, "Input"],
Cell[98424, 3486, 1041, 36, 81, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99502, 3527, 503, 16, 46, "Input"],
Cell[100008, 3545, 795, 27, 81, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[100852, 3578, 39, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[100916, 3582, 1450, 44, 97, "Input"],
Cell[102369, 3628, 157, 4, 20, "Message"],
Cell[102529, 3634, 157, 4, 20, "Message"],
Cell[102689, 3640, 157, 4, 20, "Message"],
Cell[102849, 3646, 5317, 161, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108203, 3812, 169, 5, 28, "Input"],
Cell[108375, 3819, 5224, 162, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113648, 3987, 75, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[113748, 3991, 445, 14, 28, "Input"],
Cell[114196, 4007, 2164, 72, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116397, 4084, 443, 14, 28, "Input"],
Cell[116843, 4100, 2164, 72, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[119068, 4179, 38, 0, 64, "Section"],
Cell[CellGroupData[{
Cell[119131, 4183, 84, 1, 44, "Subsection"],
Cell[119218, 4186, 482, 21, 70, "Text"],
Cell[CellGroupData[{
Cell[119725, 4211, 291, 9, 46, "Input"],
Cell[120019, 4222, 374, 14, 45, "Output"],
Cell[120396, 4238, 305, 11, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120750, 4255, 37, 0, 44, "Subsection"],
Cell[120790, 4257, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[120856, 4261, 169, 5, 28, "Input"],
Cell[121028, 4268, 340, 13, 45, "Output"]
}, Open  ]],
Cell[121383, 4284, 37, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[121445, 4288, 189, 5, 28, "Input"],
Cell[121637, 4295, 157, 4, 20, "Message"],
Cell[121797, 4301, 642, 23, 45, "Output"]
}, Open  ]],
Cell[122454, 4327, 145, 3, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122636, 4335, 66, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[122727, 4339, 425, 11, 63, "Input"],
Cell[123155, 4352, 3458, 114, 47, "Output"],
Cell[126616, 4468, 1572, 53, 47, "Output"],
Cell[128191, 4523, 1135, 38, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129375, 4567, 61, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[129461, 4571, 158, 4, 28, "Input"],
Cell[129622, 4577, 1976, 67, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131647, 4650, 52, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[131724, 4654, 137, 4, 28, "Input"],
Cell[131864, 4660, 326, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132227, 4677, 379, 12, 46, "Input"],
Cell[132609, 4691, 9888, 305, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142534, 5001, 1043, 32, 28, "Input"],
Cell[143580, 5035, 1104, 38, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144721, 5078, 312, 10, 46, "Input"],
Cell[145036, 5090, 4901, 157, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149974, 5252, 603, 19, 28, "Input"],
Cell[150580, 5273, 586, 21, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151203, 5299, 312, 10, 46, "Input"],
Cell[151518, 5311, 4651, 149, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156206, 5465, 2530, 77, 63, "Input"],
Cell[158739, 5544, 2958, 100, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161734, 5649, 404, 13, 46, "Input"],
Cell[162141, 5664, 157, 4, 20, "Message"],
Cell[162301, 5670, 2346, 76, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[164696, 5752, 50, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[164771, 5756, 214, 7, 28, "Input"],
Cell[164988, 5765, 490, 18, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165515, 5788, 88, 2, 28, "Input"],
Cell[165606, 5792, 1575, 54, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[167230, 5852, 42, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[167297, 5856, 741, 23, 63, "Input"],
Cell[168041, 5881, 1031, 35, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169109, 5921, 369, 10, 46, "Input"],
Cell[169481, 5933, 1038, 36, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170556, 5974, 369, 10, 46, "Input"],
Cell[170928, 5986, 349, 13, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[171326, 6005, 37, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[171388, 6009, 281, 8, 28, "Input"],
Cell[171672, 6019, 5869, 196, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177578, 6220, 777, 26, 28, "Input"],
Cell[178358, 6248, 1807, 64, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180202, 6317, 116, 3, 28, "Input"],
Cell[180321, 6322, 323, 11, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180681, 6338, 171, 5, 28, "Input"],
Cell[180855, 6345, 6539, 225, 63, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
