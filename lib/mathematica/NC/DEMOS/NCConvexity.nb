(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     47730,       1409]
NotebookOptionsPosition[     42637,       1244]
NotebookOutlinePosition[     43430,       1268]
CellTagsIndexPosition[     43387,       1265]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["NCConvexity Package", "Title",
 CellChangeTimes->{{3.684184817846608*^9, 3.684184837620771*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"<<", "NC`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "NCAlgebra`"}], "\[IndentingNewLine]", 
 RowBox[{"<<", " ", "NCConvexity`"}]}], "Input",
 CellChangeTimes->{{3.5166269207530003`*^9, 3.516626927007236*^9}, {
  3.516626995092029*^9, 3.516626996571578*^9}, {3.684024763041646*^9, 
  3.684024765010337*^9}, {3.684199623718852*^9, 3.684199624548519*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"You are using the version of NCAlgebra which is found in:\"\
\>"], "Print",
 CellChangeTimes->{
  3.516626928879483*^9, {3.516626976585766*^9, 3.51662699714361*^9}, 
   3.572400610539997*^9, 3.6840247876683483`*^9, {3.684025354781372*^9, 
   3.684025383032116*^9}, 3.68402577527229*^9, 3.684026019965735*^9, 
   3.6840260997527027`*^9, 3.684185463137561*^9, 3.6841972568357773`*^9, 
   3.6841973068856277`*^9, {3.68419744479678*^9, 3.684197466106689*^9}, 
   3.68419847347624*^9, 3.6841986171837463`*^9, 3.68419938973302*^9, 
   3.6841995083646507`*^9, 3.684199624901904*^9, {3.6841996560056562`*^9, 
   3.6841996827113523`*^9}, 3.684199848910677*^9, 3.6841999263496513`*^9, 
   3.700706149332604*^9, 3.7007926164280577`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"  \"\>", "\[InvisibleSpace]", "\<\"/Users/mauricio/NC\"\>"}],
  SequenceForm["  ", "/Users/mauricio/NC"],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.516626928879483*^9, {3.516626976585766*^9, 3.51662699714361*^9}, 
   3.572400610539997*^9, 3.6840247876683483`*^9, {3.684025354781372*^9, 
   3.684025383032116*^9}, 3.68402577527229*^9, 3.684026019965735*^9, 
   3.6840260997527027`*^9, 3.684185463137561*^9, 3.6841972568357773`*^9, 
   3.6841973068856277`*^9, {3.68419744479678*^9, 3.684197466106689*^9}, 
   3.68419847347624*^9, 3.6841986171837463`*^9, 3.68419938973302*^9, 
   3.6841995083646507`*^9, 3.684199624901904*^9, {3.6841996560056562`*^9, 
   3.6841996827113523`*^9}, 3.684199848910677*^9, 3.6841999263496513`*^9, 
   3.700706149332604*^9, 3.700792616436283*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"You can now use \\\"<< NCAlgebra`\\\" to load NCAlgebra or \
\"\>", "\[InvisibleSpace]", "\<\"\\\"<< NCGB`\\\" to load NCGB.\"\>"}],
  SequenceForm[
  "You can now use \"<< NCAlgebra`\" to load NCAlgebra or ", 
   "\"<< NCGB`\" to load NCGB."],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.516626928879483*^9, {3.516626976585766*^9, 3.51662699714361*^9}, 
   3.572400610539997*^9, 3.6840247876683483`*^9, {3.684025354781372*^9, 
   3.684025383032116*^9}, 3.68402577527229*^9, 3.684026019965735*^9, 
   3.6840260997527027`*^9, 3.684185463137561*^9, 3.6841972568357773`*^9, 
   3.6841973068856277`*^9, {3.68419744479678*^9, 3.684197466106689*^9}, 
   3.68419847347624*^9, 3.6841986171837463`*^9, 3.68419938973302*^9, 
   3.6841995083646507`*^9, 3.684199624901904*^9, {3.6841996560056562`*^9, 
   3.6841996827113523`*^9}, 3.684199848910677*^9, 3.6841999263496513`*^9, 
   3.700706149332604*^9, 3.700792616446159*^9}],

Cell["\<\
------------------------------------------------------------
NCAlgebra - Version 5.0
Compatible with Mathematica Version 10

Authors:
  J. William Helton*
  Mauricio de Oliveira&

* Math, UCSD, La Jolla, CA
& MAE, UCSD, La Jolla, CA

with earlier contributions by:

  Mark Stankus$ 
  Robert L. Miller#

$ Math, Cal Poly San Luis Obispo
# General Atomics Corp

Copyright: 
  Helton and de Oliveira 2017
  Helton 2002
  Helton and Miller June 1991
  All rights reserved.

The program was written by the authors and by:
  David Hurst, Daniel Lamm, Orlando Merino, Robert Obar,
  Henry Pfister, Mike Walker, John Wavrik, Lois Yu,
  J. Camino, J. Griffin, J. Ovall, T. Shaheen, John Shopple. 
  The beginnings of the program come from eran@slac.
  Considerable recent help came from Igor Klep.

This program was written with support from 
  AFOSR, NSF, ONR, Lab for Math and Statistics at UCSD,
  UCSD Faculty Mentor Program,
  and US Department of Education.
  Primary support in 2010 is from the 
    NSF Division of Mathematical Sciences.

If you 
  (1) are a user, 
  (2) want to be a user, 
  (3) refer to NCAlgebra in a publication, or 
  (4) have had an interesting experience with NCAlgebra,
let us know by sending an e-mail message to  

  ncalg@math.ucsd.edu. 

We do not want to restrict access to NCAlgebra, but do 
  want to keep track of how it is being used.

For NCAlgebra updates see:

  www.math.ucsd.edu/~ncalg
  www.github.com/NCAlgebra/NC

------------------------------------------------------------\
\>", "Print",
 CellChangeTimes->{
  3.516626928879483*^9, {3.516626976585766*^9, 3.51662699714361*^9}, 
   3.572400610539997*^9, 3.6840247876683483`*^9, {3.684025354781372*^9, 
   3.684025383032116*^9}, 3.68402577527229*^9, 3.684026019965735*^9, 
   3.6840260997527027`*^9, 3.684185463137561*^9, 3.6841972568357773`*^9, 
   3.6841973068856277`*^9, {3.68419744479678*^9, 3.684197466106689*^9}, 
   3.68419847347624*^9, 3.6841986171837463`*^9, 3.68419938973302*^9, 
   3.6841995083646507`*^9, 3.684199624901904*^9, {3.6841996560056562`*^9, 
   3.6841996827113523`*^9}, 3.684199848910677*^9, 3.6841999263496513`*^9, 
   3.700706149332604*^9, 3.70079261645811*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Chapter",
 CellChangeTimes->{{3.684197735820601*^9, 3.684197736729377*^9}, 
   3.684198335189703*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox["x", "2"]], "Subchapter",
 CellChangeTimes->{{3.684197502655561*^9, 3.68419751827872*^9}}],

Cell[TextData[{
 "Let's start with a simple example first.  Lets test the convexity of p = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "2"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{
  3.6841972362420187`*^9, {3.6841974951860437`*^9, 3.684197528984665*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", " ", 
  RowBox[{
   RowBox[{"x", "**", "x"}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], " ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.684024797042529*^9, {3.6840253565004053`*^9, 3.684025384480678*^9}, 
   3.684025776622464*^9, 3.684026021223007*^9, {3.684197245477963*^9, 
   3.684197258529814*^9}, 3.684197308794736*^9, {3.684197447121942*^9, 
   3.6841974672512712`*^9}, 3.6841975335948973`*^9, 3.684198473737254*^9, 
   3.684198619510929*^9, 3.6841993925024776`*^9, 3.684199510393799*^9, 
   3.68419962775782*^9, {3.68419965818291*^9, 3.6841996847651033`*^9}, 
   3.684199849155648*^9, 3.684199926589519*^9, 3.7007061499338837`*^9, 
   3.700792617033525*^9}],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellChangeTimes->{
  3.684197258539871*^9, 3.684197308859251*^9, {3.6841974471892843`*^9, 
   3.684197467329183*^9}, 3.684197533604632*^9, 3.684198473748124*^9, 
   3.684198619687295*^9, 3.6841993927383337`*^9, 3.684199510569394*^9, 
   3.684199627946501*^9, {3.6841996582022247`*^9, 3.6841996847762003`*^9}, 
   3.684199849167036*^9, 3.684199926601034*^9, 3.700706150017992*^9, 
   3.700792617099659*^9}]
}, Open  ]],

Cell["\<\
Conclusions: We see that x^2 is matrix convex for all symmetric x, since the \
output diagonal elements {2} are positive.\
\>", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox["x", "3"]], "Subchapter",
 CellChangeTimes->{{3.684197502655561*^9, 3.684197544267288*^9}}],

Cell[TextData[{
 "Now we will test the convexity of p = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "3"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{
  3.68419731483631*^9, {3.6841975535960007`*^9, 3.684197555226901*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", " ", 
  RowBox[{
   RowBox[{"x", "**", "x", "**", "x"}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], " ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.684025400278158*^9, 3.684025778184143*^9, 
  3.6840260227402887`*^9, 3.6841973177782383`*^9, 3.684197470992269*^9, 
  3.6841975475665827`*^9, 3.684198473946892*^9, 3.68419968741856*^9, 
  3.684199849364538*^9, 3.684199926792823*^9, 3.700706150206114*^9, 
  3.7007926172767677`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"2", " ", "x"}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["x", 
     RowBox[{"-", "1"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.5166269325840273`*^9, 3.5166269794724827`*^9, 
  3.572400611146427*^9, 3.6840254003271427`*^9, 3.684025778194172*^9, 
  3.684026022750173*^9, 3.684197317967848*^9, 3.6841974711866207`*^9, 
  3.684197547750782*^9, 3.684198474142981*^9, 3.684199687607258*^9, 
  3.684199849375719*^9, 3.684199926803892*^9, 3.700706150230835*^9, 
  3.700792617311919*^9}]
}, Open  ]],

Cell[TextData[{
 "Conclusions: We see that x",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["", "3"], TraditionalForm]]],
 " is not matrix convex for any symmetric x, since the output diagonal \
elements {2x, -2 inv[x]} cannot both be positive."
}], "Text",
 CellChangeTimes->{{3.684197560290976*^9, 3.6841975647005*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "2"], "+", 
  SuperscriptBox["y", "2"]}]], "Subchapter",
 CellChangeTimes->{{3.684197502655561*^9, 3.684197544267288*^9}, {
  3.6841975748374233`*^9, 3.684197577708856*^9}}],

Cell[TextData[{
 "What about p = ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 " ?"
}], "Text",
 CellChangeTimes->{3.684197480281443*^9, 3.684197587433572*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "**", "x"}], "+", 
    RowBox[{"y", "**", "y"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], " ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x, \
y\\\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.684025456803241*^9, 3.684025779944982*^9, 
  3.684026024779256*^9, 3.6841974826908207`*^9, 3.684197580058508*^9, 
  3.684198474325774*^9, 3.6841997307530317`*^9, 3.684199849561946*^9, 
  3.684199926994062*^9, 3.700706150410933*^9, 3.700792617499777*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.5166269795884857`*^9, 3.572400611196829*^9, 
  3.684025456810898*^9, 3.684025779954974*^9, 3.684026024789657*^9, 
  3.684197482702115*^9, 3.684197580069343*^9, 3.6841984743340273`*^9, 
  3.684199730764081*^9, 3.68419984957777*^9, 3.6841999270023937`*^9, 
  3.700706150447624*^9, 3.700792617528483*^9}]
}, Open  ]],

Cell[TextData[{
 "Conclusions: We see that ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 " is matrix convex for any symmetric x and y, since the output diagonal \
elements {2,2} are positive."
}], "Text",
 CellChangeTimes->{3.684197590022994*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 SuperscriptBox["x", "4"]], "Subchapter",
 CellChangeTimes->{{3.684197502655561*^9, 3.684197544267288*^9}, {
  3.6841975748374233`*^9, 3.6841976051017313`*^9}}],

Cell[TextData[{
 "What about p = ",
 Cell[BoxData[
  SuperscriptBox["x", "4"]]],
 " ?"
}], "Text",
 CellChangeTimes->{3.684197487921887*^9, 3.684197610233697*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", " ", 
  RowBox[{
   RowBox[{"x", "**", "x", "**", "x", "**", "x"}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], " ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.6840254725944443`*^9, 3.6840257820626583`*^9, 
  3.6840260264397173`*^9, 3.6841976122742167`*^9, 3.68419847452559*^9, 
  3.684199734963208*^9, 3.684199849773538*^9, 3.684199927201827*^9, 
  3.7007061507015047`*^9, 3.700792617705513*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.516626980447814*^9, 3.572400611248341*^9, 
  3.684025472612762*^9, 3.6840257820803003`*^9, 3.6840260264590597`*^9, 
  3.6841976124689627`*^9, 3.6841984747232447`*^9, 3.684199735158064*^9, 
  3.6841998498076553`*^9, 3.684199927227572*^9, 3.700706150710394*^9, 
  3.700792617725439*^9}]
}, Open  ]],

Cell[TextData[{
 "Conclusions: We see that ",
 Cell[BoxData[
  SuperscriptBox["x", "4"]]],
 " is not matrix convex for any symmetric x, since the eigenvalues of the \
second block of the diagonal matrix D include 2 and -2.  Note the different \
message and output here.  This is because D was not diagonal, but block \
diagonal. So, NCConvexityRegion gave back the block diagonal."
}], "Text",
 CellChangeTimes->{{3.68419762267227*^9, 3.6841976728953114`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SuperscriptBox["x", "4"], "+", 
  SuperscriptBox["y", "4"]}]], "Subchapter",
 CellChangeTimes->{{3.684197502655561*^9, 3.684197544267288*^9}, {
  3.6841975748374233`*^9, 3.6841976051017313`*^9}, {3.684197688081765*^9, 
  3.68419768985639*^9}}],

Cell[TextData[{
 "What about p = ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "4"], "+", 
   SuperscriptBox["y", "4"]}]]],
 "?"
}], "Text",
 CellChangeTimes->{{3.684197676143833*^9, 3.684197696648424*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "**", "x", "**", "x", "**", "x"}], "+", 
    RowBox[{"y", "**", "y", "**", "y", "**", "y"}]}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], " ", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x, \
y\\\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{3.684025536583488*^9, 3.6840257850272827`*^9, 
  3.6840260293768272`*^9, 3.684197698147422*^9, 3.684198474953328*^9, 
  3.684199739632057*^9, 3.68419985003985*^9, 3.684199927419896*^9, 
  3.70070615110186*^9, 3.7007926179349957`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "0"}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.516626981449554*^9, 3.572400611357563*^9, 
  3.684025536623757*^9, 3.6840257850762777`*^9, 3.684026029422127*^9, 
  3.6841976985580473`*^9, 3.684198475403194*^9, 3.684199740036817*^9, 
  3.6841998500909243`*^9, 3.684199927465719*^9, 3.70070615116181*^9, 
  3.7007926179851007`*^9}]
}, Open  ]],

Cell[TextData[{
 "Conclusions: We see that ",
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "4"], "+", 
   SuperscriptBox["y", "4"]}]]],
 " is not matrix convex for any symmetric x and y, since the eigenvalues of \
the D matrix include 2 and -2.  Note again the different message and output \
here.  This is because D was not diagonal, but block diagonal.  "
}], "Text",
 CellChangeTimes->{{3.684197706402285*^9, 3.6841977176579933`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Important", "Chapter",
 CellChangeTimes->{{3.6841981993579597`*^9, 3.684198205955122*^9}}],

Cell["NCConvexityRegion can only be used on symmetric forms :", "Text",
 CellChangeTimes->{{3.6841983648652077`*^9, 3.6841983786299458`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", 
  RowBox[{
   RowBox[{"1", "+", 
    RowBox[{"x", "**", "y"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCMatrixOfQuadratic", "::", "NotSymmetric"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"Quadratic form is not symmetric.\"\>"}]], "Message",\
 "MSG",
 CellChangeTimes->{
  3.684025849163599*^9, 3.684026052774056*^9, 3.6840261052288857`*^9, {
   3.6840261474346867`*^9, 3.6840261626432457`*^9}, 3.684026912789365*^9, 
   3.684198230920586*^9, 3.684198475643653*^9, 3.6841997434255943`*^9, 
   3.684199850445056*^9, 3.684199927708478*^9, 3.700706151376017*^9, 
   3.700792618330736*^9}],

Cell[BoxData[
 RowBox[{"{", "$Failed", "}"}]], "Output",
 CellChangeTimes->{
  3.516626984292391*^9, 3.57240061216508*^9, 3.6840258499370823`*^9, 
   3.684026053354601*^9, 3.684026106049961*^9, {3.6840261481928*^9, 
   3.684026162651144*^9}, 3.684026912799038*^9, 3.684198230931724*^9, 
   3.6841984756529007`*^9, 3.684199743436337*^9, 3.684199850453308*^9, 
   3.68419992771771*^9, 3.700706151385401*^9, 3.7007926183398438`*^9}]
}, Open  ]],

Cell["will issue a warning and return nothing.", "Text",
 CellChangeTimes->{{3.6841982327685223`*^9, 3.6841982480193043`*^9}}],

Cell["Of course, testing linear functions with NCConvexityRegion:", "Text",
 CellChangeTimes->{{3.684198294532752*^9, 3.684198297611215*^9}, {
  3.684198385141013*^9, 3.684198386277482*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NCConvexityRegion", "[", 
  RowBox[{
   RowBox[{"1", "+", "x"}], ",", " ", 
   RowBox[{"{", "x", "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.684199747283856*^9, 3.6841997553682632`*^9}, 
   3.684199850650998*^9, 3.684199927995264*^9, 3.700706151567404*^9, 
   3.700792618528039*^9}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{
  3.684198475694564*^9, {3.684199747292088*^9, 3.684199755378929*^9}, 
   3.684199850659371*^9, 3.684199928004549*^9, 3.700706151575521*^9, 
   3.700792618535972*^9}]
}, Open  ]],

Cell["\<\
returns {0} since a linear function is convex everywhere, but strictly convex \
nowhere.\
\>", "Text",
 CellChangeTimes->{{3.684198389141509*^9, 3.6841984317267647`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["What is NCConvexityRegion doing?", "Chapter",
 CellChangeTimes->{{3.684197735820601*^9, 3.684197754330592*^9}, 
   3.684198435433117*^9}],

Cell[TextData[{
 "Let's step through a couple of the above examples and do what \
NCConvexityRegion does to get a feeling for what is happening.\nLet\
\[CloseCurlyQuote]s go through p = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "3"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.684197783196515*^9, 3.684197786108786*^9}, {
  3.6841984422633047`*^9, 3.684198442567349*^9}}],

Cell["\<\
NCConvexityRegion first calculates the nc directional Hessian:\
\>", "Text",
 CellChangeTimes->{{3.684197762426545*^9, 3.684197798451734*^9}, {
  3.684197853558036*^9, 3.68419785364566*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hes", " ", "=", " ", 
  RowBox[{"NCHessian", "[", " ", 
   RowBox[{
    RowBox[{"x", "**", "x", "**", "x"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "h"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"h", "**", "h", "**", "x"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"h", "**", "x", "**", "h"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x", "**", "h", "**", "h"}]}]}]], "Output",
 CellChangeTimes->{
  3.684197805819762*^9, {3.684198111280397*^9, 3.684198117747439*^9}, 
   3.684198475827385*^9, 3.684199760024044*^9, 3.684199850709392*^9, 
   3.684199928095121*^9, 3.7007061516013927`*^9, 3.700792618555065*^9}]
}, Open  ]],

Cell["\<\
The nc directional Hessian decomposed into a product of a left row vector \
times a middle matrix times a right column vector using NCMatrixOfQuadratic:\
\>", "Text",
 CellChangeTimes->{{3.6841978122574463`*^9, 3.684197869527375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lt", ",", "mq", ",", "rt"}], "}"}], "=", " ", 
   RowBox[{"NCMatrixOfQuadratic", "[", 
    RowBox[{"hes", ",", 
     RowBox[{"{", "h", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.684197876070504*^9, 3.6841978979595613`*^9}, 
   3.700792598823885*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"h, \
x\\\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.6841978787176933`*^9, 3.684197898722618*^9}, 
   3.6841981194304533`*^9, 3.684198476019899*^9, 3.684199762659005*^9, 
   3.684199850958332*^9, 3.684199928344047*^9, 3.700706151789222*^9, 
   3.7007926187389917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ColumnForm", "[", "lt", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mq", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ColumnForm", "[", "rt", "]"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{"x", "**", "h"}]},
    {"h"}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
    NonCommutativeMultiply[$CellContext`x, $CellContext`h], $CellContext`h}],
  Editable->False]], "Output",
 CellChangeTimes->{3.684197899981908*^9, 3.684198120113133*^9, 
  3.684198476112619*^9, 3.684199765142967*^9, 3.684199851057431*^9, 
  3.68419992844503*^9, 3.70070615214211*^9, 3.700792618754139*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "2"},
     {"2", 
      RowBox[{"2", " ", "x"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 3}, {{2}, {1}, {2}}}, {2, 2, 2 $CellContext`x}}]]]]], "Output",\

 CellChangeTimes->{3.684197899981908*^9, 3.684198120113133*^9, 
  3.684198476112619*^9, 3.684199765142967*^9, 3.684199851057431*^9, 
  3.68419992844503*^9, 3.70070615214211*^9, 3.700792618762494*^9}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{"h", "**", "x"}]},
    {"h"}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
    NonCommutativeMultiply[$CellContext`h, $CellContext`x], $CellContext`h}],
  Editable->False]], "Output",
 CellChangeTimes->{3.684197899981908*^9, 3.684198120113133*^9, 
  3.684198476112619*^9, 3.684199765142967*^9, 3.684199851057431*^9, 
  3.68419992844503*^9, 3.70070615214211*^9, 3.70079261877026*^9}]
}, Open  ]],

Cell["\<\
The nc LDL factors of the middle matrix is then calculated using \
NCLDLDecomposition :\
\>", "Text",
 CellChangeTimes->{{3.684197906685491*^9, 3.684197948594006*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ldl", ",", "p", ",", "s", ",", "rank"}], "}"}], "=", 
   RowBox[{"NCLDLDecomposition", "[", "mq", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lf", ",", "d", ",", "rt"}], "}"}], "=", 
   RowBox[{"GetLDUMatrices", "[", 
    RowBox[{"ldl", ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "lf", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "d", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "rt", "]"}]}], "Input",
 CellChangeTimes->{{3.68402555422227*^9, 3.68402559685565*^9}, {
   3.684197804188644*^9, 3.6841978108285723`*^9}, 3.684197874120789*^9, {
   3.684197957705213*^9, 3.684197984273871*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSelfAdjointQ", "::", "SelfAdjointVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed self-adjoint\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.684025601953388*^9, 3.6840257885299883`*^9, 3.684026032850609*^9, {
   3.6841979560227118`*^9, 3.6841979873558292`*^9}, 3.684198121397477*^9, 
   3.6841984764129457`*^9, 3.68419976715722*^9, 3.68419985128509*^9, 
   3.684199928745014*^9, 3.700706152334326*^9, 3.700792618979467*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0"},
     {
      SuperscriptBox["x", 
       RowBox[{"-", "1"}]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 3}, {{1}, {2}, {1}}}, {
      1, 1, NonCommutativeMultiply`inv[$CellContext`x]}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.684198121406417*^9, 3.684198476422529*^9, 
   3.684199767165888*^9, 3.684199851293556*^9, 3.684199928753956*^9, 
   3.7007061523432417`*^9, 3.700792618988058*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2", " ", "x"}], "0"},
     {"0", 
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["x", 
        RowBox[{"-", "1"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 1, 2}, {{1}, {2}}}, {
      2 $CellContext`x, (-2) 
       NonCommutativeMultiply`inv[$CellContext`x]}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.684198121406417*^9, 3.684198476422529*^9, 
   3.684199767165888*^9, 3.684199851293556*^9, 3.684199928753956*^9, 
   3.7007061523432417`*^9, 3.7007926189961243`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      SuperscriptBox["x", 
       RowBox[{"-", "1"}]]},
     {"0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {2, 2}, 0, {
     1, {{0, 2, 3}, {{1}, {2}, {2}}}, {
      1, NonCommutativeMultiply`inv[$CellContext`x], 1}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.684198121406417*^9, 3.684198476422529*^9, 
   3.684199767165888*^9, 3.684199851293556*^9, 3.684199928753956*^9, 
   3.7007061523432417`*^9, 3.700792619004786*^9}]
}, Open  ]],

Cell["\<\
The output of NCConvexityRegion is the bloc diagonal of the matrix d:\
\>", "Text",
 CellChangeTimes->{{3.684197988754758*^9, 3.684198017218667*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"MatrixForm", ",", 
   RowBox[{"GetDiagonal", "[", 
    RowBox[{"d", ",", "s"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684198019439942*^9, 3.684198021428578*^9}, 
   3.684198106921139*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox[
    RowBox[{"2", " ", "x"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["x", 
      RowBox[{"-", "1"}]]}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.684198021796739*^9, {3.6841981073440847`*^9, 3.684198122836838*^9}, 
   3.684198476530405*^9, 3.684199768743021*^9, 3.684199851392819*^9, 
   3.684199928944311*^9, 3.700706152399522*^9, 3.700792619198237*^9}]
}, Open  ]],

Cell[TextData[{
 "Let's go through p = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["x", "4"], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.68419803720352*^9, 3.684198066271015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"hes", " ", "=", " ", 
  RowBox[{"NCHessian", "[", " ", 
   RowBox[{
    RowBox[{"x", "**", "x", "**", "x", "**", "x"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x", ",", "h"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684198069781047*^9, 3.684198070732782*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"h", "**", "h", "**", "x", "**", "x"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"h", "**", "x", "**", "h", "**", "x"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"h", "**", "x", "**", "x", "**", "h"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x", "**", "h", "**", "h", "**", "x"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x", "**", "h", "**", "x", "**", "h"}]}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"x", "**", "x", "**", "h", "**", "h"}]}]}]], "Output",
 CellChangeTimes->{3.684197805819762*^9, 3.6841980711211777`*^9, 
  3.6841981247089577`*^9, 3.684198476660603*^9, 3.684199769976074*^9, 
  3.684199851444375*^9, 3.684199928981995*^9, 3.7007061524478893`*^9, 
  3.7007926192483253`*^9}]
}, Open  ]],

Cell["\<\
The nc directional Hessian decomposed into a product of a left row vector \
times a middle matrix times a right column vector using NCMatrixOfQuadratic:\
\>", "Text",
 CellChangeTimes->{{3.6841978122574463`*^9, 3.684197869527375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lt", ",", "mq", ",", "rt"}], "}"}], "=", " ", 
   RowBox[{"NCMatrixOfQuadratic", "[", 
    RowBox[{"hes", ",", 
     RowBox[{"{", "h", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.684197876070504*^9, 3.6841978979595613`*^9}, 
   3.7007926072133293`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSymmetricQ", "::", "SymmetricVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"h, \
x\\\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed symmetric\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{{3.6841978787176933`*^9, 3.684197898722618*^9}, 
   3.684198073122416*^9, 3.684198126493833*^9, 3.6841984769293127`*^9, 
   3.684199771760957*^9, 3.6841998516421833`*^9, 3.684199929186482*^9, 
   3.700706152652096*^9, 3.700792619432733*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ColumnForm", "[", "lt", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "mq", "]"}], "\[IndentingNewLine]", 
 RowBox[{"ColumnForm", "[", "rt", "]"}]}], "Input"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{"x", "**", "x", "**", "h"}]},
    {
     RowBox[{"x", "**", "h"}]},
    {"h"}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
    NonCommutativeMultiply[$CellContext`x, $CellContext`x, $CellContext`h], 
    NonCommutativeMultiply[$CellContext`x, $CellContext`h], $CellContext`h}],
  Editable->False]], "Output",
 CellChangeTimes->{3.684197899981908*^9, 3.6841980745692463`*^9, 
  3.684198127465849*^9, 3.684198477196331*^9, 3.684199773388811*^9, 
  3.6841998517081614`*^9, 3.6841999293128633`*^9, 3.700706152733597*^9, 
  3.70079261944928*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "2"},
     {"0", "2", 
      RowBox[{"2", " ", "x"}]},
     {"2", 
      RowBox[{"2", " ", "x"}], 
      RowBox[{"2", " ", 
       RowBox[{"x", "**", "x"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 3, 6}, {{3}, {2}, {3}, {1}, {2}, {3}}}, {
      2, 2, 2 $CellContext`x, 2, 2 $CellContext`x, 2 
       NonCommutativeMultiply[$CellContext`x, $CellContext`x]}}]]]]], "Output",\

 CellChangeTimes->{3.684197899981908*^9, 3.6841980745692463`*^9, 
  3.684198127465849*^9, 3.684198477196331*^9, 3.684199773388811*^9, 
  3.6841998517081614`*^9, 3.6841999293128633`*^9, 3.700706152733597*^9, 
  3.7007926194571323`*^9}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     RowBox[{"h", "**", "x", "**", "x"}]},
    {
     RowBox[{"h", "**", "x"}]},
    {"h"}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  ColumnForm[{
    NonCommutativeMultiply[$CellContext`h, $CellContext`x, $CellContext`x], 
    NonCommutativeMultiply[$CellContext`h, $CellContext`x], $CellContext`h}],
  Editable->False]], "Output",
 CellChangeTimes->{3.684197899981908*^9, 3.6841980745692463`*^9, 
  3.684198127465849*^9, 3.684198477196331*^9, 3.684199773388811*^9, 
  3.6841998517081614`*^9, 3.6841999293128633`*^9, 3.700706152733597*^9, 
  3.700792619465782*^9}]
}, Open  ]],

Cell["\<\
The nc LDL factors of the middle matrix is then calculated using \
NCLDLDecomposition :\
\>", "Text",
 CellChangeTimes->{{3.684197906685491*^9, 3.684197948594006*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"ldl", ",", "p", ",", "s", ",", "rank"}], "}"}], "=", 
   RowBox[{"NCLDLDecomposition", "[", "mq", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"lf", ",", "d", ",", "rt"}], "}"}], "=", 
   RowBox[{"GetLDUMatrices", "[", 
    RowBox[{"ldl", ",", "s"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "lf", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "d", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "rt", "]"}]}], "Input",
 CellChangeTimes->{{3.68402555422227*^9, 3.68402559685565*^9}, {
   3.684197804188644*^9, 3.6841978108285723`*^9}, 3.684197874120789*^9, {
   3.684197957705213*^9, 3.684197984273871*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"NCSelfAdjointQ", "::", "SelfAdjointVariables"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The variable(s) \[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"x\\\
\\\\\"\\\"}]\\)\[NoBreak] was(were) assumed self-adjoint\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.684025601953388*^9, 3.6840257885299883`*^9, 3.684026032850609*^9, {
   3.6841979560227118`*^9, 3.6841979873558292`*^9}, 3.684198078197873*^9, 
   3.684198128914855*^9, 3.6841984774502172`*^9, 3.6841997751307287`*^9, 
   3.684199851925879*^9, 3.684199929592458*^9, 3.700706152941037*^9, 
   3.7007926196615257`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"x", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 2, 5}, {{1}, {2}, {2}, {1}, {3}}}, {
      1, 1, 0, $CellContext`x, 1}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.6841980782065477`*^9, 3.684198128923354*^9, 
   3.684198477458983*^9, 3.6841997751391783`*^9, 3.6841998519348783`*^9, 
   3.684199929601318*^9, 3.7007061529500237`*^9, 3.700792619669972*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", "0"},
     {"0", "0", "2"},
     {"0", "2", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 1, 2, 3}, {{1}, {3}, {2}}}, {2, 2, 2}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.6841980782065477`*^9, 3.684198128923354*^9, 
   3.684198477458983*^9, 3.6841997751391783`*^9, 3.6841998519348783`*^9, 
   3.684199929601318*^9, 3.7007061529500237`*^9, 3.700792619678534*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "x"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {3, 3}, 0, {
     1, {{0, 2, 4, 5}, {{1}, {3}, {2}, {3}, {3}}}, {
      1, $CellContext`x, 1, 0, 1}}]]]]], "Output",
 CellChangeTimes->{
  3.516626981524157*^9, 3.572400611396208*^9, 3.684025601798276*^9, 
   3.684025788347808*^9, 3.6840260326543417`*^9, {3.684197956032555*^9, 
   3.684197987367464*^9}, 3.6841980782065477`*^9, 3.684198128923354*^9, 
   3.684198477458983*^9, 3.6841997751391783`*^9, 3.6841998519348783`*^9, 
   3.684199929601318*^9, 3.7007061529500237`*^9, 3.700792619687385*^9}]
}, Open  ]],

Cell["\<\
The output of NCConvexityRegion is the bloc diagonal of the matrix d:\
\>", "Text",
 CellChangeTimes->{{3.684197988754758*^9, 3.684198017218667*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{"MatrixForm", ",", 
   RowBox[{"GetDiagonal", "[", 
    RowBox[{"d", ",", "s"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.684198019439942*^9, 3.684198021428578*^9}, {
  3.684198087341763*^9, 3.684198099125662*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   TagBox["2",
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], ",", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "2"},
       {"2", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[
     SparseArray[
      Automatic, {2, 2}, 0, {1, {{0, 1, 2}, {{2}, {1}}}, {2, 2}}]]]]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.684198021796739*^9, {3.684198080668374*^9, 3.68419809949259*^9}, 
   3.6841981300796213`*^9, 3.684198477530156*^9, 3.6841997763917017`*^9, 
   3.684199852009672*^9, 3.684199929676178*^9, 3.700706153069034*^9, 
   3.7007926197466383`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1034, 748},
WindowMargins->{{1, Automatic}, {Automatic, 0}},
PrintingPageRange->{Automatic, Automatic},
PrintingOptions->{"Magnification"->1,
"PaperOrientation"->"Portrait",
"PaperSize"->{612, 792},
"PostScriptOutputFile":>FrontEnd`FileName[{$RootDirectory, "home", "toal", 
   "SHAHEEN", "Summer02", "Convexity", "NewStuff", "NEWNCCONVEXITYWITHDOC"}, 
  "NCConvexityRegionDemo.nb.ps", CharacterEncoding -> "ISO8859-1"]},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
FrontEndVersion->"10.4 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 11, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 102, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[706, 27, 383, 6, 63, "Input"],
Cell[CellGroupData[{
Cell[1114, 37, 743, 11, 22, "Print"],
Cell[1860, 50, 832, 14, 21, "Print"],
Cell[2695, 66, 971, 17, 22, "Print"],
Cell[3669, 85, 2189, 68, 805, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5907, 159, 119, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[6051, 165, 120, 2, 63, "Subchapter"],
Cell[6174, 169, 280, 8, 31, "Text"],
Cell[CellGroupData[{
Cell[6479, 181, 157, 4, 28, "Input"],
Cell[6639, 187, 835, 16, 21, "Message"],
Cell[7477, 205, 457, 8, 28, "Output"]
}, Open  ]],
Cell[7949, 216, 145, 3, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8131, 224, 121, 2, 63, "Subchapter"],
Cell[8255, 228, 242, 8, 31, "Text"],
Cell[CellGroupData[{
Cell[8522, 240, 168, 4, 28, "Input"],
Cell[8693, 246, 585, 12, 21, "Message"],
Cell[9281, 260, 561, 13, 35, "Output"]
}, Open  ]],
Cell[9857, 276, 320, 8, 31, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10214, 289, 219, 5, 63, "Subchapter"],
Cell[10436, 296, 211, 8, 32, "Text"],
Cell[CellGroupData[{
Cell[10672, 308, 233, 7, 28, "Input"],
Cell[10908, 317, 560, 11, 21, "Message"],
Cell[11471, 330, 396, 7, 28, "Output"]
}, Open  ]],
Cell[11882, 340, 298, 9, 32, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12217, 354, 174, 3, 63, "Subchapter"],
Cell[12394, 359, 162, 6, 32, "Text"],
Cell[CellGroupData[{
Cell[12581, 369, 179, 4, 28, "Input"],
Cell[12763, 375, 540, 11, 21, "Message"],
Cell[13306, 388, 534, 13, 28, "Output"]
}, Open  ]],
Cell[13855, 404, 460, 9, 70, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14352, 418, 269, 6, 63, "Subchapter"],
Cell[14624, 426, 212, 8, 32, "Text"],
Cell[CellGroupData[{
Cell[14861, 438, 277, 7, 28, "Input"],
Cell[15141, 447, 538, 11, 21, "Message"],
Cell[15682, 460, 706, 19, 28, "Output"]
}, Open  ]],
Cell[16403, 482, 441, 10, 51, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16893, 498, 96, 1, 65, "Chapter"],
Cell[16992, 501, 141, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[17158, 506, 192, 6, 28, "Input"],
Cell[17353, 514, 534, 11, 21, "Message"],
Cell[17890, 527, 429, 7, 28, "Output"]
}, Open  ]],
Cell[18334, 537, 126, 1, 30, "Text"],
Cell[18463, 540, 190, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[18678, 546, 146, 4, 28, "Input"],
Cell[18827, 552, 446, 10, 21, "Message"],
Cell[19276, 564, 237, 5, 28, "Output"]
}, Open  ]],
Cell[19528, 572, 180, 4, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19745, 581, 143, 2, 65, "Chapter"],
Cell[19891, 585, 397, 10, 50, "Text"],
Cell[20291, 597, 200, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[20516, 605, 219, 6, 28, "Input"],
Cell[20738, 613, 470, 11, 28, "Output"]
}, Open  ]],
Cell[21223, 627, 244, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[21492, 635, 328, 9, 28, "Input"],
Cell[21823, 646, 523, 11, 21, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22383, 662, 196, 3, 63, "Input"],
Cell[22582, 667, 588, 15, 47, "Output"],
Cell[23173, 684, 913, 25, 58, "Output"],
Cell[24089, 711, 587, 15, 47, "Output"]
}, Open  ]],
Cell[24691, 729, 177, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[24893, 737, 773, 18, 97, "Input"],
Cell[25669, 757, 596, 12, 21, "Message"],
Cell[26268, 771, 1121, 29, 60, "Output"],
Cell[27392, 802, 1222, 33, 60, "Output"],
Cell[28617, 837, 1121, 29, 60, "Output"]
}, Open  ]],
Cell[29753, 869, 159, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[29937, 876, 244, 6, 28, "Input"],
Cell[30184, 884, 562, 17, 35, "Output"]
}, Open  ]],
Cell[30761, 904, 198, 7, 31, "Text"],
Cell[CellGroupData[{
Cell[30984, 915, 296, 7, 28, "Input"],
Cell[31283, 924, 745, 17, 28, "Output"]
}, Open  ]],
Cell[32043, 944, 244, 4, 49, "Text"],
Cell[CellGroupData[{
Cell[32312, 952, 330, 9, 28, "Input"],
Cell[32645, 963, 545, 11, 21, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33227, 979, 196, 3, 63, "Input"],
Cell[33426, 984, 746, 19, 64, "Output"],
Cell[34175, 1005, 1175, 32, 74, "Output"],
Cell[35353, 1039, 747, 19, 64, "Output"]
}, Open  ]],
Cell[36115, 1061, 177, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[36317, 1069, 773, 18, 97, "Input"],
Cell[37093, 1089, 628, 13, 21, "Message"],
Cell[37724, 1104, 1121, 28, 74, "Output"],
Cell[38848, 1134, 1085, 27, 74, "Output"],
Cell[39936, 1163, 1121, 28, 74, "Output"]
}, Open  ]],
Cell[41072, 1194, 159, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[41256, 1201, 267, 6, 28, "Input"],
Cell[41526, 1209, 1071, 30, 47, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

